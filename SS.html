<!DOCTYPE html>
<html lang="he">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="slide.png" />
    <meta name="application-name" content="×™×•×¦×¨ ××¦×’×•×ª" />

    <title>××¦×’×ª ×ª××•× ×•×ª</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        direction: rtl;
        margin: 0;
        padding: 20px;
        background-color: #027cb4;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        background-color: #c7dbff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.9);
      }

      h1 {
        font-size: 3.5rem;
        font-weight: 700;
        color: #000;
        text-align: center;
        margin-top: 0px;
        -webkit-text-stroke-width: 2px;
        -webkit-text-stroke-color: rgb(255, 255, 0);
      }

      h2 {
        margin-top: 5px;
        margin-bottom: 5px;
        font-size: 18px;
      }

      h3 {
        color: #000;
        text-align: center;
        margin-bottom: 10px;
        margin-top: -10px;
      }

      .controls {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
        display: block;
        margin-bottom: 10px;
      }

      .control-group {
        background-color: #c7dbff;
        padding: 15px;
        border-radius: 8px;
      }

      label {
        display: block;
        font-weight: bold;
        margin-bottom: 10px;
      }

      input,
      select,
      button,
      textarea {
        width: 100%;
        padding: 4px;
        margin-bottom: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
      }

      button {
        background-color: #4caf50;
        border-radius: 20px;
        color: white;
        border: none;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      button:hover {
        background-color: #45a049;
      }

      #preview {
        margin-top: -10px;
        border: 2px dashed #666;
        padding: 20px;
        border-radius: 20px;
        min-height: 400px;
        position: relative;
        overflow: hidden;
      }

      #slideshow-container {
        width: 100%;
        height: 400px;
        position: relative;
        overflow: hidden;
        margin-bottom: 20px;
      }

      .slide {
        position: absolute;
        width: 100%;
        height: 80%;
        opacity: 0;
        transition: opacity 1s;
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
        top: 10%;
        left: 50%;
        transform: translateX(-50%);
      }

      .slide.active {
        opacity: 1;
      }

      #title-display {
        position: absolute;
        top: -20px;
        left: 0;
        right: 0;
        text-align: center;
        font-size: 3.5rem;
        z-index: 10;
        -webkit-text-stroke-width: 1px;
        -webkit-text-stroke-color: rgb(255, 255, 0);
      }

      .image-caption {
        position: absolute;
        bottom: 20px;
        left: 0;
        right: 0;
        text-align: center;
        color: white;
        font-size: 24px;
        z-index: 10;
        padding: 10px;
        border-radius: 5px;
      }

      #export-section {
        margin-top: 10px;
        text-align: center;
      }

      #export-btn {
        width: 100%;
        background-color: #2196f3;
        border-radius: 20px;
        padding: 12px 24px;
        font-size: 22px;
        font-weight: 700;
        margin-top: 10px;
        margin-bottom: -10px;
      }

      #export-btn:hover {
        background-color: #075ca1;
      }

      #download-link {
        display: none;
        margin-top: 20px;
      }

      .compression-options {
        width: 100%;
        background-color: #c7dbff;
        padding: 8px;
        border-radius: 5px;
        margin-bottom: 4px;
      }

      .image-list {
        max-height: 200px;
        overflow-y: auto;
        border: 1px solid #c7dbff;
        padding: 10px;
        margin-bottom: 15px;
        background-color: #c7dbff;
      }

      .image-item {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        padding: 5px;
        background-color: #c7dbff;
        border-radius: 4px;
        gap: 15px;
      }

      .image-item img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        margin-left: 10px;
        border-radius: 3px;
      }

      .image-item .caption-input {
        flex-grow: 1;
        margin-bottom: 0;
        margin-left: 10px;
      }

      .image-item .transition-select {
        width: 120px;
        margin-bottom: 0;
        margin-left: 15px;
      }

      .progress-bar {
        width: 100%;
        background-color: #f1f1f1;
        border-radius: 5px;
        margin-bottom: 15px;
        display: contents;
      }

      .progress {
        height: 20px;
        background-color: #5e4caf;
        width: 100%;
        margin: auto;
        margin-bottom: 20px;
        border-radius: 20px;
        text-align: center;
        line-height: 20px;
        color: white;
      }

      /* ×¡×’× ×•× ×•×ª ×—×“×©×™× ×œ×›×¤×ª×•×¨×™ ×”×¢×œ××ª ×§×‘×¦×™× */
      .file-input-wrapper {
        position: relative;
        overflow: hidden;
        display: inline-block;
        width: 100%;
        margin-bottom: 15px;
      }

      .file-input-button {
        padding: 10px;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 20px;
        font-size: 20px;
        font-weight: 700;
        text-align: center;
        margin: auto;
        cursor: pointer;
      }

      .file-input-button:hover {
        background-color: #45a049;
      }

      .file-input-real {
        position: absolute;
        font-size: 100px;
        opacity: 0;
        right: 0;
        top: 0;
        cursor: pointer;
        height: 100%;
      }

      .file-input-filename {
        margin-top: 5px;
        font-size: 14px;
        color: #555;
        text-align: right;
        direction: rtl;
      }

      .title-interval-row {
        padding-right: 15px;
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .title-interval-row label {
        margin-bottom: 0;
        white-space: nowrap;
      }

      #presentation-title {
        flex: 1;
        min-width: 40px;
      }

      .interval-group {
        display: flex;
        align-items: center;
        gap: 2px;
      }

      #interval {
        width: 30px;
      }

      /*      scrollbar          */
      ::-webkit-scrollbar {
        width: 15px;
      }

      ::-webkit-scrollbar-track {
        box-shadow: inset 0 0 5px grey;
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb {
        background: rgb(255, 120, 0);
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgb(255, 80, 0);
      }

      #title-color {
        width: 40px;
        height: 40px;
        padding: 0;
        border: 1px solid #c7dbff;
        cursor: pointer;
        background: #c7dbff;
      }

      .delete-image-btn {
        background-color: #f44336 !important;
        color: white;
        border: none;
        border-radius: 3px;
        width: 40px;
        height: 40px;
        cursor: pointer;
        margin-left: 5px;
        padding: 0;
        font-size: 12px;
        line-height: 20px;
      }

      .delete-image-btn:hover {
        background-color: #d32f2f !important;
      }

      #export-section {
        margin-top: 10px;
        text-align: center;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
      }

      #refresh-btn {
        flex: 1;
        max-width: 30%;
        background-color: #f44336;
        border-radius: 20px;
        padding: 12px 24px;
        font-size: 22px;
        font-weight: 700;
        margin: 0;
      }

      #refresh-btn:hover {
        background-color: #d32f2f;
      }

      #export-btn {
        flex: 2;
        max-width: 65%;
        background-color: #2196f3;
        border-radius: 20px;
        padding: 12px 24px;
        font-size: 22px;
        font-weight: 700;
        margin: 0;
      }

      #export-btn:hover {
        background-color: #075ca1;
      }

      /* ×›×œ ×× ×™××¦×™×•×ª ×”××¢×‘×¨ */
      @keyframes blurOut {
        from {
          filter: blur(0);
          opacity: 1;
        }
        to {
          filter: blur(5px);
          opacity: 0;
        }
      }

      @keyframes blurIn {
        from {
          filter: blur(5px);
          opacity: 0;
        }
        to {
          filter: blur(0);
          opacity: 1;
        }
      }

      @keyframes swingOut {
        from {
          transform: rotate(0);
        }
        to {
          transform: rotate(15deg) translateX(100%);
          opacity: 0;
        }
      }

      @keyframes swingIn {
        from {
          transform: rotate(-15deg) translateX(-100%);
          opacity: 0;
        }
        to {
          transform: rotate(0);
          opacity: 1;
        }
      }

      @keyframes dissolveOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
        }
      }

      @keyframes dissolveIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes wipeOut {
        from {
          clip-path: inset(0 0 0 0);
        }
        to {
          clip-path: inset(0 100% 0 0);
        }
      }

      @keyframes wipeIn {
        from {
          clip-path: inset(0 0 0 100%);
        }
        to {
          clip-path: inset(0 0 0 0);
        }
      }

      @keyframes splitOut {
        from {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
        to {
          clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%),
            polygon(50% 0, 100% 0, 100% 100%, 50% 100%);
          transform: translateX(-50%) translateX(50%);
        }
      }

      @keyframes splitIn {
        from {
          clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%),
            polygon(50% 0, 100% 0, 100% 100%, 50% 100%);
          transform: translateX(-50%) translateX(50%);
        }
        to {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
      }

      @keyframes rippleOut {
        from {
          clip-path: circle(100%);
        }
        to {
          clip-path: circle(0%);
        }
      }

      @keyframes rippleIn {
        from {
          clip-path: circle(0%);
        }
        to {
          clip-path: circle(100%);
        }
      }

      @keyframes blindsOut {
        from {
          clip-path: inset(0 0 0 0);
        }
        to {
          clip-path: inset(0 0 100% 0);
        }
      }

      @keyframes blindsIn {
        from {
          clip-path: inset(100% 0 0 0);
        }
        to {
          clip-path: inset(0 0 0 0);
        }
      }

      @keyframes morphOut {
        from {
          filter: opacity(1);
        }
        to {
          filter: opacity(0);
        }
      }

      @keyframes morphIn {
        from {
          filter: opacity(0);
        }
        to {
          filter: opacity(1);
        }
      }

      @keyframes rainOut {
        from {
          transform: translateY(0);
          opacity: 1;
        }
        to {
          transform: translateY(100%);
          opacity: 0;
        }
      }

      @keyframes rainIn {
        from {
          transform: translateY(-100%);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      @keyframes shatterOut {
        from {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
        to {
          clip-path: polygon(
            0 0,
            5% 5%,
            10% 0,
            15% 5%,
            20% 0,
            25% 5%,
            30% 0,
            35% 5%,
            40% 0,
            45% 5%,
            50% 0,
            55% 5%,
            60% 0,
            65% 5%,
            70% 0,
            75% 5%,
            80% 0,
            85% 5%,
            90% 0,
            95% 5%,
            100% 0,
            95% 95%,
            90% 100%,
            85% 95%,
            80% 100%,
            75% 95%,
            70% 100%,
            65% 95%,
            60% 100%,
            55% 95%,
            50% 100%,
            45% 95%,
            40% 100%,
            35% 95%,
            30% 100%,
            25% 95%,
            20% 100%,
            15% 95%,
            10% 100%,
            5% 95%,
            0% 100%
          );
        }
      }

      @keyframes shatterIn {
        from {
          clip-path: polygon(
            0 0,
            5% 5%,
            10% 0,
            15% 5%,
            20% 0,
            25% 5%,
            30% 0,
            35% 5%,
            40% 0,
            45% 5%,
            50% 0,
            55% 5%,
            60% 0,
            65% 5%,
            70% 0,
            75% 5%,
            80% 0,
            85% 5%,
            90% 0,
            95% 5%,
            100% 0,
            95% 95%,
            90% 100%,
            85% 95%,
            80% 100%,
            75% 95%,
            70% 100%,
            65% 95%,
            60% 100%,
            55% 95%,
            50% 100%,
            45% 95%,
            40% 100%,
            35% 95%,
            30% 100%,
            25% 95%,
            20% 100%,
            15% 95%,
            10% 100%,
            5% 95%,
            0% 100%
          );
        }
        to {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
      }

      @keyframes pulseOut {
        from {
          transform: scale(1);
          opacity: 1;
        }
        to {
          transform: scale(1.5);
          opacity: 0;
        }
      }

      @keyframes pulseIn {
        from {
          transform: scale(0.5);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      @keyframes fireWorksOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
          box-shadow: 0 0 5px 5px rgba(255, 255, 0, 0.8),
            0 0 10px 10px rgba(255, 0, 0, 0.6),
            0 0 15px 15px rgba(0, 255, 0, 0.4);
        }
      }

      @keyframes fireWorksIn {
        from {
          opacity: 0;
          box-shadow: 0 0 5px 5px rgba(255, 255, 0, 0.8),
            0 0 10px 10px rgba(255, 0, 0, 0.6),
            0 0 15px 15px rgba(0, 255, 0, 0.4);
        }
        to {
          opacity: 1;
          box-shadow: none;
        }
      }

      /* ×× ×™××¦×™×•×ª × ×•×¡×¤×•×ª ×©×”×™×• ×—×¡×¨×•×ª */
      @keyframes slideOut {
        from {
          transform: translateX(0);
        }
        to {
          transform: translateX(-100%);
        }
      }

      @keyframes slideIn {
        from {
          transform: translateX(100%);
        }
        to {
          transform: translateX(0);
        }
      }

      @keyframes zoomOut {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0);
        }
      }

      @keyframes zoomIn {
        from {
          transform: scale(2);
        }
        to {
          transform: scale(1);
        }
      }

      @keyframes rotateOut {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(180deg) scale(0);
        }
      }

      @keyframes rotateIn {
        from {
          transform: rotate(-180deg) scale(0);
        }
        to {
          transform: rotate(0deg) scale(1);
        }
      }

      @keyframes flipOut {
        from {
          transform: rotateY(0);
        }
        to {
          transform: rotateY(90deg);
          opacity: 0;
        }
      }

      @keyframes flipIn {
        from {
          transform: rotateY(-90deg);
          opacity: 0;
        }
        to {
          transform: rotateY(0);
          opacity: 1;
        }
      }

      @keyframes cubeOut {
        from {
          transform: rotateY(0) translateZ(0);
        }
        to {
          transform: rotateY(-90deg) translateZ(200px);
          opacity: 0;
        }
      }

      @keyframes cubeIn {
        from {
          transform: rotateY(90deg) translateZ(200px);
          opacity: 0;
        }
        to {
          transform: rotateY(0) translateZ(0);
          opacity: 1;
        }
      }

      @keyframes glowOut {
        from {
          opacity: 1;
          filter: brightness(1);
        }
        to {
          opacity: 0;
          filter: brightness(3);
        }
      }

      @keyframes glowIn {
        from {
          opacity: 0;
          filter: brightness(3);
        }
        to {
          opacity: 1;
          filter: brightness(1);
        }
      }

      @keyframes bounceOut {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0.5) translateY(100%);
          opacity: 0;
        }
      }

      @keyframes bounceIn {
        from {
          transform: scale(0.5) translateY(-100%);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      @keyframes flipXOut {
        from {
          transform: rotateX(0);
        }
        to {
          transform: rotateX(90deg);
          opacity: 0;
        }
      }

      @keyframes flipXIn {
        from {
          transform: rotateX(-90deg);
          opacity: 0;
        }
        to {
          transform: rotateX(0);
          opacity: 1;
        }
      }

      @keyframes flipYOut {
        from {
          transform: rotateY(0);
        }
        to {
          transform: rotateY(90deg);
          opacity: 0;
        }
      }

      @keyframes flipYIn {
        from {
          transform: rotateY(-90deg);
          opacity: 0;
        }
        to {
          transform: rotateY(0);
          opacity: 1;
        }
      }

      @keyframes lightSpeedOut {
        from {
          transform: translateX(0) skewX(0);
        }
        to {
          transform: translateX(100%) skewX(-30deg);
          opacity: 0;
        }
      }

      @keyframes lightSpeedIn {
        from {
          transform: translateX(-100%) skewX(30deg);
          opacity: 0;
        }
        to {
          transform: translateX(0) skewX(0);
          opacity: 1;
        }
      }

      @keyframes rollOut {
        from {
          transform: translateX(0) rotate(0);
        }
        to {
          transform: translateX(100%) rotate(120deg);
          opacity: 0;
        }
      }

      @keyframes rollIn {
        from {
          transform: translateX(-100%) rotate(-120deg);
          opacity: 0;
        }
        to {
          transform: translateX(0) rotate(0);
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>×™×•×¦×¨ ××¦×’×•×ª</h1>

      <div class="controls">
        <div class="control-group">
          <div class="title-interval-row">
            <input
              type="text"
              id="presentation-title"
              placeholder="×›×•×ª×¨×ª ×”××¦×’×ª"
            />
            <div class="interval-group">
              <label for="interval">×¦×‘×¢ <br />×›×•×ª×¨×ª:</label>
              <input type="color" id="title-color" value="#FF0000" />
            </div>

            <div class="interval-group">
              <label for="interval">××¨×•×•×— <br />×‘×©× ×™×•×ª:</label>
              <input type="number" id="interval" value="3" min="1" max="10" />
            </div>
          </div>

          <div class="control-group">
            <label>×‘×—×™×¨×ª ×ª××•× ×•×ª (× ×™×ª×Ÿ ×œ×‘×—×•×¨ ×›××”):</label>
            <div class="file-input-wrapper">
              <button class="file-input-button">×‘×—×¨ ×§×‘×¦×™ ×ª××•× ×•×ª</button>
              <input
                type="file"
                id="images"
                class="file-input-real"
                multiple
                accept="image/*"
              />
            </div>
            <div id="images-filename" class="file-input-filename"></div>

            <div class="compression-options">
              <label for="image-quality">××™×›×•×ª ×ª××•× ×•×ª (1-100):</label>
              <input
                type="range"
                id="image-quality"
                min="1"
                max="100"
                value="80"
              />
              <span id="quality-value">80%</span>

              <label for="resize-width">×¨×•×—×‘ ××§×¡×™××œ×™ (×¤×™×§×¡×œ×™×):</label>
              <input
                type="number"
                id="resize-width"
                value="1920"
                min="100"
                max="3840"
              />
            </div>

            <label>×¨×§×¢ ×”××¦×’×ª:</label>
            <div class="file-input-wrapper">
              <button class="file-input-button">×‘×—×¨ ×§×•×‘×¥ ×¨×§×¢</button>
              <input
                type="file"
                id="background"
                class="file-input-real"
                accept="image/*"
              />
            </div>
            <div id="background-filename" class="file-input-filename"></div>

            <div class="compression-options">
              <label for="bg-quality">××™×›×•×ª ×¨×§×¢ (1-100):</label>
              <input
                type="range"
                id="bg-quality"
                min="1"
                max="100"
                value="80"
              />
              <span id="bg-quality-value">80%</span>
            </div>

            <label>××•×¡×™×§×” ×¨×§×¢ (××•×¤×¦×™×•× ×œ×™):</label>
            <div class="file-input-wrapper">
              <button class="file-input-button">×‘×—×¨ ×§×•×‘×¥ ××•×¡×™×§×”</button>
              <input
                type="file"
                id="music"
                class="file-input-real"
                accept="audio/*"
              />
            </div>
            <div id="music-filename" class="file-input-filename"></div>
          </div>
        </div>

        <div id="image-captions-container" style="display: none">
          <h3>×›×•×ª×¨×•×ª ×•××¢×‘×¨×™× ×œ×ª××•× ×•×ª:</h3>
          <div class="image-list" id="image-list">
            <!-- ×›××Ÿ ×™×•×¤×™×¢×• ×”×ª××•× ×•×ª ×•×”×˜×§×¡×˜×™× -->
          </div>
        </div>

        <div class="progress-bar" id="progress-bar">
          <div class="progress" id="progress">0%</div>
        </div>

        <div id="preview">
          <h3>×ª×¦×•×’×” ××§×“×™××”:</h3>
          <div id="slideshow-container">
            <div id="title-display">×›×•×ª×¨×ª ×”××¦×’×ª</div>
            <!-- ×›××Ÿ ×™×•×¤×™×¢×• ×”×ª××•× ×•×ª -->
          </div>
        </div>

        <div id="export-section">
          <button id="export-btn">×™×¦× ×œ×§×•×‘×¥ HTML</button>
          <button id="refresh-btn">× ×™×§×•×™ ×•×¨×¢× ×•×Ÿ</button>
        </div>
      </div>

      <script>
        // ××œ×× ×˜×™× ××”×“×£
        const titleInput = document.getElementById("presentation-title");
        const titleColorInput = document.getElementById("title-color");
        const intervalInput = document.getElementById("interval");
        const imagesInput = document.getElementById("images");
        const backgroundInput = document.getElementById("background");
        const musicInput = document.getElementById("music");
        const slideshowContainer = document.getElementById(
          "slideshow-container"
        );
        const titleDisplay = document.getElementById("title-display");
        const exportBtn = document.getElementById("export-btn");
        const refreshBtn = document.getElementById("refresh-btn");
        const imageList = document.getElementById("image-list");
        const imageCaptionsContainer = document.getElementById(
          "image-captions-container"
        );
        const progressBar = document.getElementById("progress-bar");
        const progress = document.getElementById("progress");

        // ××œ×× ×˜×™× ×—×“×©×™× ×œ×ª×¦×•×’×ª ×©××•×ª ×§×‘×¦×™×
        const imagesFilename = document.getElementById("images-filename");
        const backgroundFilename = document.getElementById(
          "background-filename"
        );
        const musicFilename = document.getElementById("music-filename");

        // ×”×’×“×¨×•×ª ×›×™×•×•×¥
        const imageQuality = document.getElementById("image-quality");
        const qualityValue = document.getElementById("quality-value");
        const resizeWidth = document.getElementById("resize-width");
        const bgQuality = document.getElementById("bg-quality");
        const bgQualityValue = document.getElementById("bg-quality-value");

        // ×§×‘×™×¢×ª ×‘×¨×™×¨×ª ××—×“×œ ×œ××¢×‘×¨×™×
        const defaultTransition = "fade";

        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ××™×›×•×ª
        imageQuality.addEventListener("input", function () {
          qualityValue.textContent = this.value + "%";
        });

        bgQuality.addEventListener("input", function () {
          bgQualityValue.textContent = this.value + "%";
        });

        // ×¢×“×›×•×Ÿ ×¦×‘×¢ ×”×›×•×ª×¨×ª
        titleColorInput.addEventListener("input", function () {
          titleDisplay.style.color = this.value;
        });

        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ×©××•×ª ×§×‘×¦×™×
        imagesInput.addEventListener("change", function (e) {
          const files = e.target.files;
          if (files.length > 0) {
            if (files.length === 1) {
              imagesFilename.textContent = "× ×‘×—×¨×” ×ª××•× ×” ××—×ª: " + files[0].name;
            } else {
              imagesFilename.textContent = "× ×‘×—×¨×• " + files.length + " ×ª××•× ×•×ª";
            }
          } else {
            imagesFilename.textContent = "";
          }
        });

        backgroundInput.addEventListener("change", function (e) {
          const file = e.target.files[0];
          backgroundFilename.textContent = file ? file.name : "";
        });

        musicInput.addEventListener("change", function (e) {
          const file = e.target.files[0];
          musicFilename.textContent = file ? file.name : "";
        });

        // ××©×ª× ×™× ×’×œ×•×‘×œ×™×™×
        let slides = [];
        let currentSlideIndex = 0;
        let slideInterval;
        let backgroundImage = "";
        let musicFile = null;
        let imageCaptions = [];
        let compressedImages = [];
        let transitions = [];

        // ×¢×“×›×•×Ÿ ×›×•×ª×¨×ª ×‘×–××Ÿ ×××ª
        titleInput.addEventListener("input", function () {
          titleDisplay.textContent = this.value;
        });

        // ×˜×¢×™× ×ª ×ª××•× ×•×ª
        imagesInput.addEventListener("change", async function (e) {
          const files = e.target.files;
          if (slides.length === 0) {
            slideshowContainer.innerHTML =
              '<div id="title-display" style="color: ' +
              titleColorInput.value +
              '">' +
              titleDisplay.textContent +
              "</div>";
          }

          imageCaptionsContainer.style.display = "block";

          if (files.length > 0) {
            progressBar.style.display = "block";
            progress.style.width = "0%";
            progress.textContent = "0%";

            const startIndex = slides.length;

            for (let i = 0; i < files.length; i++) {
              try {
                progress.style.width = `${
                  ((startIndex + i) / (startIndex + files.length)) * 100
                }%`;
                progress.textContent = `${Math.round(
                  ((startIndex + i) / (startIndex + files.length)) * 100
                )}%`;

                const compressedImg = await compressImage(
                  files[i],
                  imageQuality.value,
                  resizeWidth.value
                );
                compressedImages.push(compressedImg);

                const imageItem = document.createElement("div");
                imageItem.className = "image-item";

                const imgPreview = document.createElement("img");
                imgPreview.src = compressedImg;

                const deleteBtn = document.createElement("button");
                deleteBtn.textContent = "ğŸ—‘ï¸";
                deleteBtn.className = "delete-image-btn";
                deleteBtn.dataset.index = startIndex + i;
                deleteBtn.addEventListener("click", function () {
                  removeImage(parseInt(this.dataset.index));
                });

                const captionInput = document.createElement("input");
                captionInput.type = "text";
                captionInput.placeholder = "×›×•×ª×¨×ª ×œ×ª××•× ×” ×–×•";
                captionInput.dataset.index = startIndex + i;
                captionInput.className = "caption-input";
                captionInput.addEventListener("input", updateCaption);

                const transitionSelect = document.createElement("select");
                transitionSelect.dataset.index = startIndex + i;
                transitionSelect.className = "transition-select";
                transitionSelect.innerHTML = `
                  <option value="fade">×¢××¢×•×</option>
                  <option value="slide">×”×—×œ×§×”</option>
                  <option value="zoom">×ª×§×¨×™×‘</option>
                  <option value="rotate">×¡×™×‘×•×‘</option>
                  <option value="flip">×”×™×¤×•×š</option>
                  <option value="cube">×§×•×‘×™×™×” ×ª×œ×ª ××™××“×™×ª</option>
                  <option value="glow">× ×¦× ×•×¥</option>
                  <option value="bounce">×§×¤×™×¦×”</option>
                  <option value="flipX">×”×™×¤×•×š ××•×¤×§×™</option>
                  <option value="flipY">×”×™×¤×•×š ×× ×›×™</option>
                  <option value="lightSpeed">××”×™×¨×•×ª ××•×¨</option>
                  <option value="roll">×’×œ×’×•×œ</option>
                  <option value="blur">×˜×©×˜×•×©</option>
                  <option value="swing">× ×“× ×•×“</option>
                  <option value="dissolve">×”×ª××•×¡×¡×•×ª</option>
                  <option value="wipe">× ×™×’×•×‘</option>
                  <option value="split">×¤×™×¦×•×œ</option>
                  <option value="ripple">×’×œ×™×</option>
                  <option value="blinds">×ª×¨×™×¡×™×</option>
                  <option value="morph">××•×¨×¤×™× ×’</option>
                  <option value="rain">×’×©×</option>
                  <option value="shatterOut">×”×ª×¨×¡×§×•×ª</option>
                  <option value="pulse">×¤×¢×™××”</option>
                  <option value="fireWorks">×–×™×§×•×§×™×</option>
                `;
                transitionSelect.value = defaultTransition;
                transitionSelect.addEventListener("change", updateTransition);

                imageItem.appendChild(captionInput);
                imageItem.appendChild(transitionSelect);
                imageItem.appendChild(imgPreview);
                imageItem.appendChild(deleteBtn);
                imageList.appendChild(imageItem);

                const slide = document.createElement("div");
                slide.className = "slide";
                slide.style.backgroundImage = `url(${compressedImg})`;

                const caption = document.createElement("div");
                caption.className = "image-caption";
                caption.textContent = "";
                caption.id = `caption-${startIndex + i}`;
                slide.appendChild(caption);

                slideshowContainer.appendChild(slide);
                slides.push(slide);
                transitions.push(defaultTransition);
                imageCaptions.push("");

                if (slides.length === 1) {
                  slide.classList.add("active");
                }
              } catch (error) {
                console.error("Error processing image:", error);
              }
            }

            progress.style.width = "100%";
            progress.textContent = "100%";
            setTimeout(() => (progressBar.style.display = "none"), 1000);

            startSlideshow();
          }
        });

        function removeImage(index) {
          // ×”×¡×¨×ª ×”××œ×× ×˜×™× ××”×“×£
          slides[index].remove();
          imageList.children[index].remove();

          // ×¢×“×›×•×Ÿ ×”××¢×¨×›×™×
          slides.splice(index, 1);
          compressedImages.splice(index, 1);
          imageCaptions.splice(index, 1);
          transitions.splice(index, 1);

          // ×¢×“×›×•×Ÿ ×”××™× ×“×§×¡×™× ×©×œ ×”××œ×× ×˜×™× ×”× ×•×ª×¨×™×
          const items = imageList.querySelectorAll(".image-item");
          items.forEach((item, i) => {
            item.querySelector(".caption-input").dataset.index = i;
            item.querySelector(".transition-select").dataset.index = i;
            item.querySelector(".delete-image-btn").dataset.index = i;
          });

          // ×× ×–×• ×”×™×™×ª×” ×”×©×§×•×¤×™×ª ×”×¤×¢×™×œ×”, × ×¢×‘×•×¨ ×œ×©×§×•×¤×™×ª 0
          if (currentSlideIndex === index) {
            currentSlideIndex = 0;
            if (slides.length > 0) {
              slides[0].classList.add("active");
            }
          } else if (currentSlideIndex > index) {
            currentSlideIndex--;
          }

          // ×× ××™×Ÿ ×™×•×ª×¨ ×©×§×•×¤×™×•×ª, × ×§×” ××ª ×”×ª×¦×•×’×” ×”××§×“×™××”
          if (slides.length === 0) {
            slideshowContainer.innerHTML =
              '<div id="title-display" style="color: ' +
              titleColorInput.value +
              '">' +
              titleDisplay.textContent +
              "</div>";
            imageCaptionsContainer.style.display = "none";
          }
        }

        function updateCaption(e) {
          const index = parseInt(e.target.dataset.index);
          imageCaptions[index] = e.target.value;
          document.getElementById(`caption-${index}`).textContent =
            e.target.value;
        }

        function updateTransition(e) {
          const index = parseInt(e.target.dataset.index);
          transitions[index] = e.target.value;
        }

        async function compressImage(file, quality, maxWidth) {
          return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = function (event) {
              const img = new Image();
              img.onload = function () {
                const canvas = document.createElement("canvas");
                let width = img.width;
                let height = img.height;

                if (width > maxWidth) {
                  height = (maxWidth / width) * height;
                  width = maxWidth;
                }

                canvas.width = width;
                canvas.height = height;

                const ctx = canvas.getContext("2d");
                ctx.drawImage(img, 0, 0, width, height);

                canvas.toBlob(
                  function (blob) {
                    const reader = new FileReader();
                    reader.onload = function () {
                      resolve(reader.result);
                    };
                    reader.readAsDataURL(blob);
                  },
                  "image/jpeg",
                  quality / 100
                );
              };
              img.onerror = reject;
              img.src = event.target.result;
            };
            reader.onerror = reject;
            reader.readAsDataURL(file);
          });
        }

        backgroundInput.addEventListener("change", async function (e) {
          const file = e.target.files[0];
          if (file) {
            try {
              backgroundImage = await compressImage(
                file,
                bgQuality.value,
                resizeWidth.value
              );
              document.getElementById(
                "preview"
              ).style.backgroundImage = `url(${backgroundImage})`;
              document.getElementById("preview").style.backgroundSize = "cover";
            } catch (error) {
              console.error("Error processing background:", error);
            }
          }
        });

        musicInput.addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file) {
            if (file.size > 5 * 1024 * 1024) {
              if (confirm("×§×•×‘×¥ ×”××•×¡×™×§×” ×’×“×•×œ ×-5MB. ×¨×¦×•×Ÿ ×œ×”××©×™×š ×œ×œ× ×“×—×™×¡×”?")) {
                readMusicFile(file);
              }
            } else {
              readMusicFile(file);
            }
          }
        });

        function readMusicFile(file) {
          const reader = new FileReader();
          reader.onload = function (event) {
            musicFile = event.target.result;
          };
          reader.readAsDataURL(file);
        }

        function startSlideshow() {
          clearInterval(slideInterval);

          const interval = intervalInput.value * 1000;
          slideInterval = setInterval(nextSlide, interval);
        }

        function nextSlide() {
          if (slides.length === 0) return;

          const currentSlide = slides[currentSlideIndex];
          currentSlide.classList.remove("active");

          currentSlideIndex = (currentSlideIndex + 1) % slides.length;
          const nextSlide = slides[currentSlideIndex];
          nextSlide.classList.add("active");

          const transition =
            transitions[currentSlideIndex] || defaultTransition;
          applyTransition(currentSlide, nextSlide, transition);
        }

        function applyTransition(current, next, transition) {
          current.style.animation = "";
          next.style.animation = "";

          switch (transition) {
            case "fade":
              break;
            case "slide":
              current.style.animation = "slideOut 2s forwards";
              next.style.animation = "slideIn 2s forwards";
              break;
            case "zoom":
              current.style.animation = "zoomOut 2s forwards";
              next.style.animation = "zoomIn 2s forwards";
              break;
            case "rotate":
              current.style.animation = "rotateOut 2s forwards";
              next.style.animation = "rotateIn 2s forwards";
              break;
            case "flip":
              current.style.animation = "flipOut 2s forwards";
              next.style.animation = "flipIn 2s forwards";
              break;
            case "cube":
              current.style.animation = "cubeOut 2s forwards";
              next.style.animation = "cubeIn 2s forwards";
              break;
            case "glow":
              current.style.animation = "glowOut 2s forwards";
              next.style.animation = "glowIn 2s forwards";
              break;
            case "bounce":
              current.style.animation = "bounceOut 2s forwards";
              next.style.animation = "bounceIn 2s forwards";
              break;
            case "flipX":
              current.style.animation = "flipXOut 2s forwards";
              next.style.animation = "flipXIn 2s forwards";
              break;
            case "flipY":
              current.style.animation = "flipYOut 2s forwards";
              next.style.animation = "flipYIn 2s forwards";
              break;
            case "lightSpeed":
              current.style.animation = "lightSpeedOut 2s forwards";
              next.style.animation = "lightSpeedIn 2s forwards";
              break;
            case "roll":
              current.style.animation = "rollOut 2s forwards";
              next.style.animation = "rollIn 2s forwards";
              break;
            case "blur":
              current.style.animation = "blurOut 2s forwards";
              next.style.animation = "blurIn 2s forwards";
              break;
            case "swing":
              current.style.animation = "swingOut 2s forwards";
              next.style.animation = "swingIn 2s forwards";
              break;
            case "dissolve":
              current.style.animation = "dissolveOut 2s forwards";
              next.style.animation = "dissolveIn 2s forwards";
              break;
            case "wipe":
              current.style.animation = "wipeOut 2s forwards";
              next.style.animation = "wipeIn 2s forwards";
              break;
            case "split":
              current.style.animation = "splitOut 2s forwards";
              next.style.animation = "splitIn 2s forwards";
              break;
            case "ripple":
              current.style.animation = "rippleOut 2s forwards";
              next.style.animation = "rippleIn 2s forwards";
              break;
            case "blinds":
              current.style.animation = "blindsOut 2s forwards";
              next.style.animation = "blindsIn 2s forwards";
              break;
            case "morph":
              current.style.animation = "morphOut 2s forwards";
              next.style.animation = "morphIn 2s forwards";
              break;
            case "rain":
              current.style.animation = "rainOut 2s forwards";
              next.style.animation = "rainIn 2s forwards";
              break;
            case "shatterOut":
              current.style.animation = "shatterOut 2s forwards";
              next.style.animation = "shatterIn 2s forwards";
              break;
            case "pulse":
              current.style.animation = "pulseOut 2s forwards";
              next.style.animation = "pulseIn 2s forwards";
              break;
            case "fireWorks":
              current.style.animation = "fireWorksOut 2s forwards";
              next.style.animation = "fireWorksIn 2s forwards";
              break;
          }
        }

        refreshBtn.addEventListener("click", function () {
          location.reload();
        });

        exportBtn.addEventListener("click", function () {
          if (slides.length === 0) {
            alert("×× × ×”×¢×œ×” ×œ×¤×—×•×ª ×ª××•× ×” ××—×ª ×œ×¤× ×™ ×”×™×¦×•×");
            return;
          }

          let htmlContent = `<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${titleInput.value || "××¦×’×ª ×ª××•× ×•×ª"}</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            direction: rtl;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        
        #slideshow-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
            ${
              backgroundImage
                ? `background-image: url(${backgroundImage}); background-size: cover;`
                : ""
            }
        }
        
        .slide {
            position: absolute;
            width: 80%;
            height: 80%;
            opacity: 0;
            transition: opacity 1s;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            top: 10%;
            left: 10%;
        }
        
        .slide.active {
            opacity: 1;
        }
        
        #title-display {
            position: absolute;
            top: 20px;
            left: 25%;
            right: 25%;
            text-align: center;
            color: ${titleColorInput.value};
            font-size: 3.5rem;
            z-index: 10;
            -webkit-text-stroke-width: 1px;
            -webkit-text-stroke-color: rgb(255, 255, 0);
        }
        
        .image-caption {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            text-align: center;
            color: white;
            -webkit-text-stroke-width: 2px;
            -webkit-text-stroke-color: rgb(0, 0, 0);
            font-size: 40px;
            z-index: 10;
            padding: 10px;
            border-radius: 5px;
        }
        
        /* ×›×œ ×× ×™××¦×™×•×ª ×”××¢×‘×¨ */
        @keyframes slideOut {
            from { transform: translateX(0); }
            to { transform: translateX(-100%); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        @keyframes zoomOut {
            from { transform: scale(1); }
            to { transform: scale(0); }
        }
        
        @keyframes zoomIn {
            from { transform: scale(2); }
            to { transform: scale(1); }
        }
        
        @keyframes rotateOut {
            from { transform: rotate(0deg); }
            to { transform: rotate(180deg) scale(0); }
        }
        
        @keyframes rotateIn {
            from { transform: rotate(-180deg) scale(0); }
            to { transform: rotate(0deg) scale(1); }
        }
        
        @keyframes flipOut {
            from { transform: rotateY(0); }
            to { transform: rotateY(90deg); opacity: 0; }
        }
        
        @keyframes flipIn {
            from { transform: rotateY(-90deg); opacity: 0; }
            to { transform: rotateY(0); opacity: 1; }
        }
        
        @keyframes cubeOut {
            from { transform: rotateY(0) translateZ(0); }
            to { transform: rotateY(-90deg) translateZ(200px); opacity: 0; }
        }
        
        @keyframes cubeIn {
            from { transform: rotateY(90deg) translateZ(200px); opacity: 0; }
            to { transform: rotateY(0) translateZ(0); opacity: 1; }
        }
        
        @keyframes glowOut {
            from { opacity: 1; filter: brightness(1); }
            to { opacity: 0; filter: brightness(3); }
        }
        
        @keyframes glowIn {
            from { opacity: 0; filter: brightness(3); }
            to { opacity: 1; filter: brightness(1); }
        }
        
        @keyframes bounceOut {
            from { transform: scale(1); }
            to { transform: scale(0.5) translateY(100%); opacity: 0; }
        }
        
        @keyframes bounceIn {
            from { transform: scale(0.5) translateY(-100%); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        @keyframes flipXOut {
            from { transform: rotateX(0); }
            to { transform: rotateX(90deg); opacity: 0; }
        }
        
        @keyframes flipXIn {
            from { transform: rotateX(-90deg); opacity: 0; }
            to { transform: rotateX(0); opacity: 1; }
        }
        
        @keyframes flipYOut {
            from { transform: rotateY(0); }
            to { transform: rotateY(90deg); opacity: 0; }
        }
        
        @keyframes flipYIn {
            from { transform: rotateY(-90deg); opacity: 0; }
            to { transform: rotateY(0); opacity: 1; }
        }
        
        @keyframes lightSpeedOut {
            from { transform: translateX(0) skewX(0); }
            to { transform: translateX(100%) skewX(-30deg); opacity: 0; }
        }
        
        @keyframes lightSpeedIn {
            from { transform: translateX(-100%) skewX(30deg); opacity: 0; }
            to { transform: translateX(0) skewX(0); opacity: 1; }
        }
        
        @keyframes rollOut {
            from { transform: translateX(0) rotate(0); }
            to { transform: translateX(100%) rotate(120deg); opacity: 0; }
        }
        
        @keyframes rollIn {
            from { transform: translateX(-100%) rotate(-120deg); opacity: 0; }
            to { transform: translateX(0) rotate(0); opacity: 1; }
        }
        
        @keyframes blurOut {
            from { filter: blur(0); opacity: 1; }
            to { filter: blur(5px); opacity: 0; }
        }
        
        @keyframes blurIn {
            from { filter: blur(5px); opacity: 0; }
            to { filter: blur(0); opacity: 1; }
        }
        
        @keyframes swingOut {
            from { transform: rotate(0); }
            to { transform: rotate(15deg) translateX(100%); opacity: 0; }
        }
        
        @keyframes swingIn {
            from { transform: rotate(-15deg) translateX(-100%); opacity: 0; }
            to { transform: rotate(0); opacity: 1; }
        }
        
        @keyframes dissolveOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        @keyframes dissolveIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes wipeOut {
            from { clip-path: inset(0 0 0 0); }
            to { clip-path: inset(0 100% 0 0); }
        }
        
        @keyframes wipeIn {
            from { clip-path: inset(0 0 0 100%); }
            to { clip-path: inset(0 0 0 0); }
        }
        
        @keyframes splitOut {
            from { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
            to { 
              clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%),
                         polygon(50% 0, 100% 0, 100% 100%, 50% 100%); 
              transform: translateX(-50%) translateX(50%);
            }
        }
        
        @keyframes splitIn {
            from { 
              clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%),
                         polygon(50% 0, 100% 0, 100% 100%, 50% 100%); 
              transform: translateX(-50%) translateX(50%);
            }
            to { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
        }
        
        @keyframes rippleOut {
            from { clip-path: circle(100%); }
            to { clip-path: circle(0%); }
        }
        
        @keyframes rippleIn {
            from { clip-path: circle(0%); }
            to { clip-path: circle(100%); }
        }
        
        @keyframes blindsOut {
            from { clip-path: inset(0 0 0 0); }
            to { clip-path: inset(0 0 100% 0); }
        }
        
        @keyframes blindsIn {
            from { clip-path: inset(100% 0 0 0); }
            to { clip-path: inset(0 0 0 0); }
        }
        
        @keyframes morphOut {
            from { filter: opacity(1); }
            to { filter: opacity(0); }
        }
        
        @keyframes morphIn {
            from { filter: opacity(0); }
            to { filter: opacity(1); }
        }
        
        @keyframes rainOut {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(100%); opacity: 0; }
        }
        
        @keyframes rainIn {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes shatterOut {
            from { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
            to { 
              clip-path: polygon(
                0 0, 5% 5%, 10% 0, 15% 5%, 20% 0, 25% 5%, 30% 0, 35% 5%, 40% 0, 45% 5%, 
                50% 0, 55% 5%, 60% 0, 65% 5%, 70% 0, 75% 5%, 80% 0, 85% 5%, 90% 0, 95% 5%, 
                100% 0, 95% 95%, 90% 100%, 85% 95%, 80% 100%, 75% 95%, 70% 100%, 65% 95%, 
                60% 100%, 55% 95%, 50% 100%, 45% 95%, 40% 100%, 35% 95%, 30% 100%, 25% 95%, 
                20% 100%, 15% 95%, 10% 100%, 5% 95%, 0% 100%
              );
            }
        }
        
        @keyframes shatterIn {
            from { 
              clip-path: polygon(
                0 0, 5% 5%, 10% 0, 15% 5%, 20% 0, 25% 5%, 30% 0, 35% 5%, 40% 0, 45% 5%, 
                50% 0, 55% 5%, 60% 0, 65% 5%, 70% 0, 75% 5%, 80% 0, 85% 5%, 90% 0, 95% 5%, 
                100% 0, 95% 95%, 90% 100%, 85% 95%, 80% 100%, 75% 95%, 70% 100%, 65% 95%, 
                60% 100%, 55% 95%, 50% 100%, 45% 95%, 40% 100%, 35% 95%, 30% 100%, 25% 95%, 
                20% 100%, 15% 95%, 10% 100%, 5% 95%, 0% 100%
              );
            }
            to { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
        }
        
        @keyframes pulseOut {
            from { transform: scale(1); opacity: 1; }
            to { transform: scale(1.5); opacity: 0; }
        }
        
        @keyframes pulseIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        @keyframes fireWorksOut {
            from { opacity: 1; }
            to { 
              opacity: 0; 
              box-shadow: 0 0 5px 5px rgba(255, 255, 0, 0.8),
                          0 0 10px 10px rgba(255, 0, 0, 0.6),
                          0 0 15px 15px rgba(0, 255, 0, 0.4);
            }
        }
        
        @keyframes fireWorksIn {
            from { 
              opacity: 0; 
              box-shadow: 0 0 5px 5px rgba(255, 255, 0, 0.8),
                          0 0 10px 10px rgba(255, 0, 0, 0.6),
                          0 0 15px 15px rgba(0, 255, 0, 0.4);
            }
            to { 
              opacity: 1; 
              box-shadow: none;
            }
        }
        
        #music-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }
        
        #play-music-btn, #pause-music-btn {
            padding: 10px 15px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        #pause-music-btn {
            background: #f44336;
        }
    </style>
</head>
<body>
    <div id="slideshow-container">
        <div id="title-display" style="color: ${titleColorInput.value}">${
            titleInput.value || "×›×•×ª×¨×ª ×”××¦×’×ª"
          }</div>`;

          for (let i = 0; i < slides.length; i++) {
            const imgUrl = compressedImages[i];
            const caption = imageCaptions[i] || "";
            htmlContent += `
<div class="slide${
              i === 0 ? " active" : ""
            }" style="background-image: url(${imgUrl})">
    <div class="image-caption">${caption}</div>
</div>`;
          }

          htmlContent += `
        </div>
        
        ${
          musicFile
            ? `<audio id="bg-music" loop autoplay><source src="${musicFile}" type="audio/mpeg"></audio>
            <div id="music-controls">
                <button id="play-music-btn">×”×¤×¢×œ ××•×¡×™×§×”</button>
                <button id="pause-music-btn">×”×©×ª×§ ××•×¡×™×§×”</button>
            </div>`
            : ""
        }
        
        <script>
        const slides = document.querySelectorAll('.slide');
        let currentSlideIndex = 0;
        const interval = ${intervalInput.value * 1000};
        const transitions = ${JSON.stringify(transitions)};
        let musicPlaying = false;
        
        window.onload = function() {
            if (slides.length > 0) {
                slides[0].classList.add('active');
            }
            
            const bgMusic = document.getElementById('bg-music');
            const playBtn = document.getElementById('play-music-btn');
            const pauseBtn = document.getElementById('pause-music-btn');
            
            if (bgMusic) {
                bgMusic.play().then(() => {
                    musicPlaying = true;
                    playBtn.style.display = 'none';
                    pauseBtn.style.display = 'block';
                }).catch(e => {
                    console.log('×”×¤×¢×œ×” ××•×˜×•××˜×™×ª × ×›×©×œ×” (××’×‘×œ×•×ª ×“×¤×“×¤×Ÿ):', e);
                });
                
                document.addEventListener('click', function playOnFirstInteraction() {
                    if (!musicPlaying) {
                        bgMusic.play().then(() => {
                            musicPlaying = true;
                            playBtn.style.display = 'none';
                            pauseBtn.style.display = 'block';
                        }).catch(e => {
                            console.log('×”×¤×¢×œ×ª ××•×¡×™×§×” × ×›×©×œ×”:', e);
                        });
                        document.removeEventListener('click', playOnFirstInteraction);
                    }
                }, { once: true });
                
                document.addEventListener('keydown', function playOnFirstKey() {
                    if (!musicPlaying) {
                        bgMusic.play().then(() => {
                            musicPlaying = true;
                            playBtn.style.display = 'none';
                            pauseBtn.style.display = 'block';
                        }).catch(e => {
                            console.log('×”×¤×¢×œ×ª ××•×¡×™×§×” × ×›×©×œ×”:', e);
                        });
                        document.removeEventListener('keydown', playOnFirstKey);
                    }
                }, { once: true });
                
                playBtn.addEventListener('click', function() {
                    bgMusic.play();
                    musicPlaying = true;
                    playBtn.style.display = 'none';
                    pauseBtn.style.display = 'block';
                });
                
                pauseBtn.addEventListener('click', function() {
                    bgMusic.pause();
                    musicPlaying = false;
                    playBtn.style.display = 'block';
                    pauseBtn.style.display = 'none';
                });
            }
        };
        
        function nextSlide() {
            const currentSlide = slides[currentSlideIndex];
            currentSlide.classList.remove('active');
            
            currentSlideIndex = (currentSlideIndex + 1) % slides.length;
            const nextSlide = slides[currentSlideIndex];
            nextSlide.classList.add('active');
            
            const transition = transitions[currentSlideIndex] || 'fade';
            applyTransition(currentSlide, nextSlide, transition);
        }
        
        function applyTransition(current, next, transition) {
            current.style.animation = '';
            next.style.animation = '';
            
            switch (transition) {
                case 'fade':
                    break;
                case 'slide':
                    current.style.animation = 'slideOut 2s forwards';
                    next.style.animation = 'slideIn 2s forwards';
                    break;
                case 'zoom':
                    current.style.animation = 'zoomOut 2s forwards';
                    next.style.animation = 'zoomIn 2s forwards';
                    break;
                case 'rotate':
                    current.style.animation = 'rotateOut 2s forwards';
                    next.style.animation = 'rotateIn 2s forwards';
                    break;
                case 'flip':
                    current.style.animation = 'flipOut 2s forwards';
                    next.style.animation = 'flipIn 2s forwards';
                    break;
                case 'cube':
                    current.style.animation = 'cubeOut 2s forwards';
                    next.style.animation = 'cubeIn 2s forwards';
                    break;
                case 'glow':
                    current.style.animation = 'glowOut 2s forwards';
                    next.style.animation = 'glowIn 2s forwards';
                    break;
                case 'bounce':
                    current.style.animation = 'bounceOut 2s forwards';
                    next.style.animation = 'bounceIn 2s forwards';
                    break;
                case 'flipX':
                    current.style.animation = 'flipXOut 2s forwards';
                    next.style.animation = 'flipXIn 2s forwards';
                    break;
                case 'flipY':
                    current.style.animation = 'flipYOut 2s forwards';
                    next.style.animation = 'flipYIn 2s forwards';
                    break;
                case 'lightSpeed':
                    current.style.animation = 'lightSpeedOut 2s forwards';
                    next.style.animation = 'lightSpeedIn 2s forwards';
                    break;
                case 'roll':
                    current.style.animation = 'rollOut 2s forwards';
                    next.style.animation = 'rollIn 2s forwards';
                    break;
                case 'blur':
                    current.style.animation = 'blurOut 2s forwards';
                    next.style.animation = 'blurIn 2s forwards';
                    break;
                case 'swing':
                    current.style.animation = 'swingOut 2s forwards';
                    next.style.animation = 'swingIn 2s forwards';
                    break;
                case 'dissolve':
                    current.style.animation = 'dissolveOut 2s forwards';
                    next.style.animation = 'dissolveIn 2s forwards';
                    break;
                case 'wipe':
                    current.style.animation = 'wipeOut 2s forwards';
                    next.style.animation = 'wipeIn 2s forwards';
                    break;
                case 'split':
                    current.style.animation = 'splitOut 2s forwards';
                    next.style.animation = 'splitIn 2s forwards';
                    break;
                case 'ripple':
                    current.style.animation = 'rippleOut 2s forwards';
                    next.style.animation = 'rippleIn 2s forwards';
                    break;
                case 'blinds':
                    current.style.animation = 'blindsOut 2s forwards';
                    next.style.animation = 'blindsIn 2s forwards';
                    break;
                case 'morph':
                    current.style.animation = 'morphOut 2s forwards';
                    next.style.animation = 'morphIn 2s forwards';
                    break;
                case 'rain':
                    current.style.animation = 'rainOut 2s forwards';
                    next.style.animation = 'rainIn 2s forwards';
                    break;
                case 'shatterOut':
                    current.style.animation = 'shatterOut 2s forwards';
                    next.style.animation = 'shatterIn 2s forwards';
                    break;
                case 'pulse':
                    current.style.animation = 'pulseOut 2s forwards';
                    next.style.animation = 'pulseIn 2s forwards';
                    break;
                case 'fireWorks':
                    current.style.animation = 'fireWorksOut 2s forwards';
                    next.style.animation = 'fireWorksIn 2s forwards';
                    break;
            }
        }
        
        setInterval(nextSlide, interval);
        <\/script>
    </body>
</html>`;

          try {
            const blob = new Blob([htmlContent], { type: "text/html" });
            const url = URL.createObjectURL(blob);

            const a = document.createElement("a");
            a.href = url;
            a.download = (titleInput.value || "slideshow") + ".html";
            document.body.appendChild(a);
            a.click();

            setTimeout(() => {
              document.body.removeChild(a);
              window.URL.revokeObjectURL(url);
            }, 100);
          } catch (e) {
            console.error("×©×’×™××” ×‘×™×¦×™×¨×ª ×”×§×•×‘×¥:", e);
            alert("××™×¨×¢×” ×©×’×™××” ×‘×™×¦×™×¨×ª ×”×§×•×‘×¥");
          }
        });
      </script>
    </div>
  </body>
</html>
