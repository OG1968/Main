<!DOCTYPE html>
<html lang="he">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="slide.png" />
    <meta name="application-name" content="×™×•×¦×¨ ××¦×’×•×ª" />

    <title>××¦×’×ª ×ª××•× ×•×ª</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        direction: rtl;
        margin: 0;
        padding: 20px;
        background-color: #027cb4;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        background-color: #c7dbff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.9);
      }

      h1 {
        line-height: 1rem;
        font-size: 3.5rem;
        font-weight: 700;
        color: #000;
        text-align: center;
        margin-top: 15px;
        margin-bottom: 15px;
        -webkit-text-stroke-width: 3px;
        -webkit-text-stroke-color: rgb(255, 255, 0);
      }

      h2 {
        margin-top: 5px;
        margin-bottom: 5px;
        font-size: 18px;
      }

      h3 {
        color: #000;
        text-align: center;
        margin-bottom: -10px;
        margin-top: -20px;
      }

      .controls {
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
        display: block;
        margin-bottom: 10px;
      }

      .control-group {
        background-color: #c7dbff;
        padding: 15px;
        border-radius: 8px;
      }

      label {
        display: block;
        font-weight: bold;
        margin-bottom: 10px;
      }

      input,
      select,
      button,
      textarea {
        width: 100%;
        padding: 4px;
        margin-bottom: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
      }

      button {
        background-color: #4caf50;
        border-radius: 20px;
        color: white;
        cursor: pointer;
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
      }

      .file-input-wrapper:hover button {
        background-color: #2c632f;
        transform: translateY(0px);
        box-shadow: 0 0px 2px rgb(0, 0, 0);
      }

      #preview {
        margin-top: -10px;
        border: 2px dashed #666;
        padding: 20px;
        border-radius: 20px;
        min-height: 400px;
        position: relative;
        overflow: hidden;
      }

      #slideshow-container {
        width: 100%;
        height: 400px;
        position: relative;
        overflow: hidden;
        margin-bottom: 20px;
      }

      .slide {
        position: absolute;
        width: 100%;
        height: 80%;
        opacity: 0;
        transition: opacity 1s;
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
        top: 10%;
        left: 50%;
        transform: translateX(-50%);
      }

      .slide.active {
        opacity: 1;
      }

      #title-display {
        position: absolute;
        top: -18px;
        left: 0;
        right: 0;
        text-align: center;
        font-size: 3.5rem;
        font-weight: 600;
        z-index: 10;
        -webkit-text-stroke-width: 2px;
        -webkit-text-stroke-color: rgb(255, 255, 0);
      }

      .image-caption {
        position: absolute;
        bottom: 20px;
        left: 0;
        right: 0;
        text-align: center;
        color: white;
        font-size: 24px;
        z-index: 10;
        padding: 10px;
        border-radius: 5px;
      }

      #export-section {
        margin-top: 10px;
        text-align: center;
      }

      #download-link {
        display: none;
        margin-top: 20px;
      }

      .compression-options {
        width: 100%;
        background-color: #c7dbff;
        padding: 8px;
        border-radius: 5px;
        margin-bottom: 4px;
      }

      .image-list {
        max-height: 200px;
        overflow-y: auto;
        border: 1px solid #c7dbff;
        padding: 10px;
        margin-bottom: 15px;
        background-color: #c7dbff;
      }

      .image-item {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        padding: 5px;
        background-color: #c7dbff;
        border-radius: 4px;
        gap: 15px;
      }

      .image-item img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        margin-left: 10px;
        border-radius: 3px;
      }

      .image-item .caption-input {
        flex-grow: 1;
        margin-bottom: 0;
        margin-left: 10px;
      }

      .image-item .transition-select {
        width: 120px;
        margin-bottom: 0;
        margin-left: 15px;
      }

      .progress-bar {
        width: 100%;
        background-color: #f1f1f1;
        border-radius: 5px;
        margin-bottom: 15px;
        display: contents;
      }

      .progress {
        height: 20px;
        background-color: #5e4caf;
        width: 100%;
        margin: auto;
        margin-bottom: 20px;
        margin-top: -5px;
        border-radius: 20px;
        text-align: center;
        line-height: 20px;
        color: white;
      }

      .file-input-wrapper {
        position: relative;
        overflow: hidden;
        width: 100%;
        margin-bottom: -0px;
      }

      .file-input-button {
        padding: 10px;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 20px;
        font-size: 20px;
        font-weight: 700;
        text-align: center;
        margin: auto;
        cursor: pointer;
      }

      .file-input-button:hover {
        background-color: #45a049;
      }

      .file-input-real {
        position: absolute;
        font-size: 100px;
        opacity: 0;
        right: 0;
        top: 0;
        cursor: pointer;
        height: 100%;
      }

      .file-input-filename {
        margin-top: 5px;
        font-size: 14px;
        color: #555;
        text-align: right;
        direction: rtl;
      }

      /* ×”×ª×××” ×œ××¡×›×™× ×¦×¨×™× */
      .title-interval-row {
        padding-right: 15px;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 15px;
      }

      .title-interval-row label {
        margin-bottom: 0;
        white-space: nowrap;
      }

      #presentation-title {
        flex: 1 1 100%;
        min-width: 40px;
        order: 1;
      }

      .interval-group {
        display: flex;
        align-items: center;
        gap: 0px;
        order: 2;
      }

      #interval {
        width: 25px;
      }

      /* ×‘××¡×›×™× ×¨×—×‘×™× × ×¡×“×¨ ××ª ×”×©×•×¨×” ×‘×¦×•×¨×” ××•×¤×§×™×ª */
      @media (min-width: 768px) {
        .title-interval-row {
          flex-wrap: nowrap;
        }
        #presentation-title {
          flex: 1;
          order: 0;
        }
        .interval-group {
          order: 0;
        }
        .image-item .caption-input {
          grid-area: caption;
          margin-left: 0;
          width: 100%;
        }
        .image-item .transition-select {
          grid-area: transition;
          width: 100px;
          margin-left: 0;
          margin-bottom: 0;
        }
        .image-item img {
          grid-area: preview;
          width: 40px;
          height: 40px;
          margin-left: 0;
        }

        .image-item .delete-image-btn {
          margin: auto;
          grid-area: delete;
          width: 40px;
          height: 40px;
          margin-left: 0;
        }

        #title-display {
          top: -10px;
          font-size: 4rem;
          font-weight: 700;
        }
      }

      /* ×”×•×¡×£ ××ª ×–×” ×‘×—×œ×§ ×”-CSS */
      @media (max-width: 650px) {
        .image-item {
          display: grid;
          grid-template-columns: 1fr auto auto;
          grid-template-areas:
            "caption caption caption"
            "transition preview delete";
          gap: 5px;
          padding: 5px;
          margin-bottom: 8px;
        }

        .image-item .caption-input {
          grid-area: caption;
          margin-left: 0;
          width: 100%;
        }

        .image-item .transition-select {
          grid-area: transition;
          width: 100px;
          margin-left: 0;
          margin-bottom: 0;
        }

        .image-item img {
          grid-area: preview;
          width: 40px;
          height: 40px;
          margin-left: 0;
        }

        .image-item .delete-image-btn {
          grid-area: delete;
          width: 40px;
          height: 40px;
          margin-left: 0;
        }

        #title-display {
          top: -10px;
          font-size: 2.2rem;
          font-weight: 700;
        }
      }

      /*      scrollbar          */
      ::-webkit-scrollbar {
        width: 20px;
      }

      ::-webkit-scrollbar-track {
        box-shadow: inset 0 0 5px grey;
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb {
        background: rgb(255, 120, 0);
        border: 4px solid rgba(255, 255, 255, 0.9);
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgb(255, 80, 0);
      }

      #title-color {
        width: 40px;
        height: 40px;
        padding: 0;
        border: 1px solid #c7dbff;
        cursor: pointer;
        background: #c7dbff;
      }

      .delete-image-btn {
        margin: auto;
        background-color: #f44336;
        color: white;
        border: none;
        border-radius: 3px;
        width: 50px;
        height: 50px;
        cursor: pointer;
        margin-left: 5px;
        padding: 0;
        font-size: 12px;
        line-height: 20px;
      }

      .delete-image-btn:hover {
        background-color: #d32f2f;
        transform: translateY(-2px);
        box-shadow: 0 0px 8px rgb(0, 0, 0);
      }

      #export-section {
        margin-top: 10px;
        text-align: center;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
      }

      #refresh-btn {
        flex: 1;
        max-width: 30%;
        background-color: #f44336;
        border-radius: 20px;
        padding: 12px 24px;
        font-size: 22px;
        font-weight: 700;
        margin: 0;
      }

      #refresh-btn:hover {
        background-color: #d32f2f;
        transform: translateY(-2px);
        box-shadow: 0 0px 8px rgb(0, 0, 0);
      }

      #export-btn {
        flex: 2;
        max-width: 65%;
        background-color: #2196f3;
        border-radius: 20px;
        padding: 12px 24px;
        font-size: 22px;
        font-weight: 700;
        margin: 0;
      }

      #export-btn:hover {
        background-color: #075ca1;
        transform: translateY(-2px);
        box-shadow: 0 0px 8px rgb(0, 0, 0);
      }

      /* ×›×œ ×× ×™××¦×™×•×ª ×”××¢×‘×¨ */

      @keyframes ripple {
        0% {
          transform: scale(0, 0);
          opacity: 0.5;
        }
        100% {
          transform: scale(20, 20);
          opacity: 0;
        }
      }

      @keyframes blurOut {
        from {
          filter: blur(0);
          opacity: 1;
        }
        to {
          filter: blur(5px);
          opacity: 0;
        }
      }

      @keyframes blurIn {
        from {
          filter: blur(5px);
          opacity: 0;
        }
        to {
          filter: blur(0);
          opacity: 1;
        }
      }

      @keyframes swingOut {
        from {
          transform: rotate(0);
        }
        to {
          transform: rotate(15deg) translateX(100%);
          opacity: 0;
        }
      }

      @keyframes swingIn {
        from {
          transform: rotate(-15deg) translateX(-100%);
          opacity: 0;
        }
        to {
          transform: rotate(0);
          opacity: 1;
        }
      }

      @keyframes wipeOut {
        from {
          clip-path: inset(0 0 0 0);
        }
        to {
          clip-path: inset(0 100% 0 0);
        }
      }

      @keyframes wipeIn {
        from {
          clip-path: inset(0 0 0 100%);
        }
        to {
          clip-path: inset(0 0 0 0);
        }
      }

      @keyframes splitOut {
        from {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
        to {
          clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%),
            polygon(50% 0, 100% 0, 100% 100%, 50% 100%);
          transform: translateX(-50%) translateX(50%);
        }
      }

      @keyframes splitIn {
        from {
          clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%),
            polygon(50% 0, 100% 0, 100% 100%, 50% 100%);
          transform: translateX(-50%) translateX(50%);
        }
        to {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
      }

      @keyframes rippleOut {
        from {
          clip-path: circle(100%);
        }
        to {
          clip-path: circle(0%);
        }
      }

      @keyframes rippleIn {
        from {
          clip-path: circle(0%);
        }
        to {
          clip-path: circle(100%);
        }
      }

      @keyframes blindsOut {
        from {
          clip-path: inset(0 0 0 0);
        }
        to {
          clip-path: inset(0 0 100% 0);
        }
      }

      @keyframes blindsIn {
        from {
          clip-path: inset(100% 0 0 0);
        }
        to {
          clip-path: inset(0 0 0 0);
        }
      }

      @keyframes rainOut {
        from {
          transform: translateY(0);
          opacity: 1;
        }
        to {
          transform: translateY(100%);
          opacity: 0;
        }
      }

      @keyframes rainIn {
        from {
          transform: translateY(-100%);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      @keyframes pulseOut {
        from {
          transform: scale(1);
          opacity: 1;
        }
        to {
          transform: scale(1.5);
          opacity: 0;
        }
      }

      @keyframes pulseIn {
        from {
          transform: scale(0.5);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      @keyframes fireWorksOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
          box-shadow: 0 0 5px 5px rgba(255, 255, 0, 0.8),
            0 0 10px 10px rgba(255, 0, 0, 0.6),
            0 0 15px 15px rgba(0, 255, 0, 0.4);
        }
      }

      @keyframes fireWorksIn {
        from {
          opacity: 0;
          box-shadow: 0 0 5px 5px rgba(255, 255, 0, 0.8),
            0 0 10px 10px rgba(255, 0, 0, 0.6),
            0 0 15px 15px rgba(0, 255, 0, 0.4);
        }
        to {
          opacity: 1;
          box-shadow: none;
        }
      }

      @keyframes slideOut {
        from {
          transform: translateX(0);
        }
        to {
          transform: translateX(-100%);
        }
      }

      @keyframes slideIn {
        from {
          transform: translateX(100%);
        }
        to {
          transform: translateX(0);
        }
      }

      @keyframes zoomOut {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0);
        }
      }

      @keyframes zoomIn {
        from {
          transform: scale(2);
        }
        to {
          transform: scale(1);
        }
      }

      @keyframes rotateOut {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(180deg) scale(0);
        }
      }

      @keyframes rotateIn {
        from {
          transform: rotate(-180deg) scale(0);
        }
        to {
          transform: rotate(0deg) scale(1);
        }
      }

      @keyframes flipOut {
        from {
          transform: rotateY(0);
        }
        to {
          transform: rotateY(90deg);
          opacity: 0;
        }
      }

      @keyframes flipIn {
        from {
          transform: rotateY(-90deg);
          opacity: 0;
        }
        to {
          transform: rotateY(0);
          opacity: 1;
        }
      }

      @keyframes glowOut {
        from {
          opacity: 1;
          filter: brightness(1);
        }
        to {
          opacity: 0;
          filter: brightness(3);
        }
      }

      @keyframes glowIn {
        from {
          opacity: 0;
          filter: brightness(3);
        }
        to {
          opacity: 1;
          filter: brightness(1);
        }
      }

      @keyframes bounceOut {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0.5) translateY(100%);
          opacity: 0;
        }
      }

      @keyframes bounceIn {
        from {
          transform: scale(0.5) translateY(-100%);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      @keyframes flipXOut {
        from {
          transform: rotateX(0);
        }
        to {
          transform: rotateX(90deg);
          opacity: 0;
        }
      }

      @keyframes flipXIn {
        from {
          transform: rotateX(-90deg);
          opacity: 0;
        }
        to {
          transform: rotateX(0);
          opacity: 1;
        }
      }

      @keyframes flipYOut {
        from {
          transform: rotateY(0);
        }
        to {
          transform: rotateY(90deg);
          opacity: 0;
        }
      }

      @keyframes flipYIn {
        from {
          transform: rotateY(-90deg);
          opacity: 0;
        }
        to {
          transform: rotateY(0);
          opacity: 1;
        }
      }

      @keyframes lightSpeedOut {
        from {
          transform: translateX(0) skewX(0);
        }
        to {
          transform: translateX(100%) skewX(-30deg);
          opacity: 0;
        }
      }

      @keyframes lightSpeedIn {
        from {
          transform: translateX(-100%) skewX(30deg);
          opacity: 0;
        }
        to {
          transform: translateX(0) skewX(0);
          opacity: 1;
        }
      }

      @keyframes rollOut {
        from {
          transform: translateX(0) rotate(0);
        }
        to {
          transform: translateX(100%) rotate(120deg);
          opacity: 0;
        }
      }

      @keyframes rollIn {
        from {
          transform: translateX(-100%) rotate(-120deg);
          opacity: 0;
        }
        to {
          transform: translateX(0) rotate(0);
          opacity: 1;
        }
      }

      @keyframes floatOut {
        from {
          transform: translateY(0);
        }
        to {
          transform: translateY(-100px) scale(0.8);
          opacity: 0;
        }
      }

      @keyframes floatIn {
        from {
          transform: translateY(100px) scale(0.8);
          opacity: 0;
        }
        to {
          transform: translateY(0) scale(1);
          opacity: 1;
        }
      }

      @keyframes shrinkOut {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0);
          opacity: 0;
        }
      }

      @keyframes shrinkIn {
        from {
          transform: scale(1.5);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      @keyframes expandOut {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(1.5);
          opacity: 0;
        }
      }

      @keyframes expandIn {
        from {
          transform: scale(0.5);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      @keyframes opacityIn {
        from {
          opacity: 0.3;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes pageFlipOut {
        from {
          transform: rotateY(0);
        }
        to {
          transform: rotateY(-180deg);
          opacity: 0;
        }
      }

      @keyframes pageFlipIn {
        from {
          transform: rotateY(180deg);
          opacity: 0;
        }
        to {
          transform: rotateY(0);
          opacity: 1;
        }
      }

      @keyframes vortexOut {
        from {
          transform: scale(1) rotate(0);
        }
        to {
          transform: scale(0) rotate(720deg);
          opacity: 0;
        }
      }

      @keyframes vortexIn {
        from {
          transform: scale(0) rotate(-720deg);
          opacity: 0;
        }
        to {
          transform: scale(1) rotate(0);
          opacity: 1;
        }
      }

      @keyframes slideDiagonalOut {
        from {
          transform: translate(0, 0);
        }
        to {
          transform: translate(100%, 100%);
          opacity: 0;
        }
      }

      @keyframes slideDiagonalIn {
        from {
          transform: translate(-100%, -100%);
          opacity: 0;
        }
        to {
          transform: translate(0, 0);
          opacity: 1;
        }
      }

      @keyframes pixelateOut {
        from {
          filter: blur(0);
        }
        to {
          filter: blur(10px) contrast(200%);
          opacity: 0;
        }
      }

      @keyframes pixelateIn {
        from {
          filter: blur(10px) contrast(200%);
          opacity: 0;
        }
        to {
          filter: blur(0) contrast(100%);
          opacity: 1;
        }
      }

      @keyframes colorShiftOut {
        from {
          filter: hue-rotate(0);
        }
        to {
          filter: hue-rotate(180deg) brightness(2);
          opacity: 0;
        }
      }

      @keyframes colorShiftIn {
        from {
          filter: hue-rotate(-180deg) brightness(2);
          opacity: 0;
        }
        to {
          filter: hue-rotate(0) brightness(1);
          opacity: 1;
        }
      }

      @keyframes curtainOut {
        from {
          clip-path: inset(0 0 0 0);
        }
        to {
          clip-path: inset(0 50% 0 50%);
        }
      }

      @keyframes curtainIn {
        from {
          clip-path: inset(0 50% 0 50%);
        }
        to {
          clip-path: inset(0 0 0 0);
        }
      }

      @keyframes explodeOut {
        from {
          clip-path: circle(100%);
        }
        to {
          clip-path: circle(0%);
          transform: scale(1.5);
        }
      }

      @keyframes explodeIn {
        from {
          clip-path: circle(0%);
          transform: scale(1.5);
        }
        to {
          clip-path: circle(100%);
          transform: scale(1);
        }
      }

      @keyframes warpOut {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(1.2) skew(20deg, 20deg);
          opacity: 0;
        }
      }

      @keyframes warpIn {
        from {
          transform: scale(0.8) skew(-20deg, -20deg);
          opacity: 0;
        }
        to {
          transform: scale(1) skew(0, 0);
          opacity: 1;
        }
      }

      @keyframes jigsawIn {
        from {
          clip-path: polygon(
            0 0,
            50% 0,
            50% 50%,
            0 50%,
            0 50%,
            50% 50%,
            50% 100%,
            0 100%,
            50% 0,
            100% 0,
            100% 50%,
            50% 50%,
            50% 50%,
            100% 50%,
            100% 100%,
            50% 100%
          );
        }
        to {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
      }

      @keyframes flashIn {
        0%,
        100% {
          opacity: 0;
        }
        50% {
          opacity: 1;
        }
      }

      @keyframes thunderOut {
        0% {
          opacity: 1;
          filter: brightness(1);
        }
        10% {
          filter: brightness(3);
        }
        20% {
          filter: brightness(1);
        }
        30% {
          filter: brightness(4);
        }
        100% {
          opacity: 0;
        }
      }

      @keyframes thunderIn {
        0% {
          opacity: 0;
          filter: brightness(4);
        }
        70% {
          filter: brightness(1);
        }
        80% {
          filter: brightness(3);
        }
        90% {
          filter: brightness(1);
        }
        100% {
          opacity: 1;
        }
      }

      @keyframes smokeOut {
        from {
          filter: blur(0) opacity(1);
        }
        to {
          filter: blur(20px) opacity(0);
          transform: translateY(-50px);
        }
      }

      @keyframes smokeIn {
        from {
          filter: blur(20px) opacity(0);
          transform: translateY(50px);
        }
        to {
          filter: blur(0) opacity(1);
          transform: translateY(0);
        }
      }

      @keyframes hourglassOut {
        from {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
        to {
          clip-path: polygon(50% 0, 50% 0, 50% 100%, 50% 100%);
        }
      }

      @keyframes hourglassIn {
        from {
          clip-path: polygon(50% 0, 50% 0, 50% 100%, 50% 100%);
        }
        to {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
      }

      @keyframes heartbeatIn {
        0% {
          opacity: 0;
          transform: scale(0.5);
        }
        25% {
          transform: scale(0.6);
        }
        50% {
          transform: scale(0.5);
        }
        75% {
          transform: scale(0.4);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes starsOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
          box-shadow: 0 0 5px 5px rgba(255, 255, 255, 0.8),
            0 0 10px 10px rgba(255, 255, 255, 0.6),
            0 0 15px 15px rgba(255, 255, 255, 0.4);
        }
      }

      @keyframes starsIn {
        from {
          opacity: 0;
          box-shadow: 0 0 5px 5px rgba(255, 255, 255, 0.8),
            0 0 10px 10px rgba(255, 255, 255, 0.6),
            0 0 15px 15px rgba(255, 255, 255, 0.4);
        }
        to {
          opacity: 1;
          box-shadow: none;
        }
      }

      @keyframes gridOut {
        from {
          clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }
        to {
          clip-path: polygon(
            0 0,
            33% 0,
            33% 33%,
            0 33%,
            0 33%,
            33% 33%,
            33% 66%,
            0 66%,
            0 66%,
            33% 66%,
            33% 100%,
            0 100%,
            33% 0,
            66% 0,
            66% 33%,
            33% 33%,
            33% 33%,
            66% 33%,
            66% 66%,
            33% 66%,
            33% 66%,
            66% 66%,
            66% 100%,
            33% 100%,
            66% 0,
            100% 0,
            100% 33%,
            66% 33%,
            66% 33%,
            100% 33%,
            100% 66%,
            66% 66%,
            66% 66%,
            100% 66%,
            100% 100%,
            66% 100%
          );
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>×™×•×¦×¨ ××¦×’×•×ª</h1>

      <div class="controls">
        <div class="control-group">
          <div class="title-interval-row">
            <input
              type="text"
              id="presentation-title"
              placeholder="×›×•×ª×¨×ª ×”××¦×’×ª"
            />
            <div class="interval-group">
              <label for="interval">××¨×•×•×— <br />×‘×©× ×™×•×ª:</label>
              <input type="number" id="interval" value="3" min="1" max="10" />
            </div>
            <div class="interval-group">
              <label for="title-color">×¦×‘×¢ <br />×›×•×ª×¨×ª:</label>
              <input type="color" id="title-color" value="#FF0000" />
            </div>
          </div>

          <div class="control-group">
            <label>×‘×—×™×¨×ª ×ª××•× ×•×ª:</label>
            <div class="file-input-wrapper">
              <button class="file-input-button">×‘×—×¨ ×§×‘×¦×™ ×ª××•× ×•×ª</button>
              <input
                type="file"
                id="images"
                class="file-input-real"
                multiple
                accept="image/*"
              />
            </div>
            <div id="images-filename" class="file-input-filename"></div>

            <div class="compression-options">
              <label for="image-quality"
                >××™×›×•×ª ×ª××•× ×•×ª:<span id="quality-value"> 80%</span>
              </label>
              <input
                type="range"
                id="image-quality"
                min="1"
                max="100"
                value="80"
              />
              <label for="resize-width">×¨×•×—×‘ ××§×¡×™××œ×™ (×‘×¤×™×§×¡×œ×™×):</label>
              <input
                type="number"
                id="resize-width"
                value="1920"
                min="100"
                max="3840"
              />
            </div>

            <label>×¨×§×¢ ×”××¦×’×ª:</label>
            <div class="file-input-wrapper">
              <button class="file-input-button">×‘×—×¨ ×§×•×‘×¥ ×¨×§×¢</button>
              <input
                type="file"
                id="background"
                class="file-input-real"
                accept="image/*"
              />
            </div>
            <div id="background-filename" class="file-input-filename"></div>

            <div class="compression-options">
              <label for="bg-quality"
                >××™×›×•×ª ×¨×§×¢: <span id="bg-quality-value">80%</span>
              </label>
              <input
                type="range"
                id="bg-quality"
                min="1"
                max="100"
                value="80"
              />
            </div>

            <label>××•×¡×™×§×” ×¨×§×¢ (××•×¤×¦×™×•× ×œ×™):</label>
            <div class="file-input-wrapper">
              <button class="file-input-button">×‘×—×¨ ×§×•×‘×¥ ××•×¡×™×§×”</button>
              <input
                type="file"
                id="music"
                class="file-input-real"
                accept="audio/*"
              />
            </div>
            <div id="music-filename" class="file-input-filename"></div>
          </div>
        </div>

        <div id="image-captions-container">
          <h3>×›×•×ª×¨×•×ª ×•××¢×‘×¨×™× ×œ×ª××•× ×•×ª:</h3>
          <div class="image-list" id="image-list">
            <!-- ×›××Ÿ ×™×•×¤×™×¢×• ×”×ª××•× ×•×ª ×•×”×˜×§×¡×˜×™× -->
          </div>
        </div>

        <div class="progress-bar" id="progress-bar">
          <div class="progress" id="progress">0%</div>
        </div>

        <div id="preview">
          <div id="slideshow-container">
            <div id="title-display">×›×•×ª×¨×ª ×”××¦×’×ª</div>
            <!-- ×›××Ÿ ×™×•×¤×™×¢×• ×”×ª××•× ×•×ª -->
          </div>
        </div>

        <div id="export-section">
          <button id="export-btn">×™×¦× ×œ×§×•×‘×¥ HTML</button>
          <button id="refresh-btn">× ×™×§×•×™ ×•×¨×¢× ×•×Ÿ</button>
        </div>
      </div>

      <script>
        // ××œ×× ×˜×™× ××”×“×£
        const titleInput = document.getElementById("presentation-title");
        const titleColorInput = document.getElementById("title-color");
        const intervalInput = document.getElementById("interval");
        const imagesInput = document.getElementById("images");
        const backgroundInput = document.getElementById("background");
        const musicInput = document.getElementById("music");
        const slideshowContainer = document.getElementById(
          "slideshow-container"
        );
        const titleDisplay = document.getElementById("title-display");
        const exportBtn = document.getElementById("export-btn");
        const refreshBtn = document.getElementById("refresh-btn");
        const imageList = document.getElementById("image-list");
        const imageCaptionsContainer = document.getElementById(
          "image-captions-container"
        );
        const progressBar = document.getElementById("progress-bar");
        const progress = document.getElementById("progress");
        const imagesFilename = document.getElementById("images-filename");
        const backgroundFilename = document.getElementById(
          "background-filename"
        );
        const musicFilename = document.getElementById("music-filename");

        // ×”×’×“×¨×•×ª ×›×™×•×•×¥
        const imageQuality = document.getElementById("image-quality");
        const qualityValue = document.getElementById("quality-value");
        const resizeWidth = document.getElementById("resize-width");
        const bgQuality = document.getElementById("bg-quality");
        const bgQualityValue = document.getElementById("bg-quality-value");

        // ×§×‘×™×¢×ª ×‘×¨×™×¨×ª ××—×“×œ ×œ××¢×‘×¨×™×
        const defaultTransition = "fade";

        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ××™×›×•×ª
        imageQuality.addEventListener("input", function () {
          qualityValue.textContent = this.value + "%";
        });

        bgQuality.addEventListener("input", function () {
          bgQualityValue.textContent = this.value + "%";
        });

        // ×¢×“×›×•×Ÿ ×¦×‘×¢ ×”×›×•×ª×¨×ª
        titleColorInput.addEventListener("input", function () {
          titleDisplay.style.color = this.value;
        });

        // ×©××™×¨×ª ×”×ª××•× ×•×ª ×”××§×•×¨×™×•×ª
        let originalImages = [];
        let imageUrls = []; // ×œ×©××™×¨×ª ×”-URLs ×©×œ ×”×ª××•× ×•×ª ×œ×ª×¦×•×’×” ××§×“×™××”

        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ×©××•×ª ×§×‘×¦×™×
        imagesInput.addEventListener("change", function (e) {
          const files = e.target.files;
          if (files.length > 0) {
            if (files.length === 1) {
              imagesFilename.textContent = "× ×‘×—×¨×” ×ª××•× ×” ××—×ª: " + files[0].name;
            } else {
              imagesFilename.textContent = "× ×‘×—×¨×• " + files.length + " ×ª××•× ×•×ª";
            }
          } else {
            imagesFilename.textContent = "";
          }
        });

        backgroundInput.addEventListener("change", function (e) {
          const file = e.target.files[0];
          backgroundFilename.textContent = file ? file.name : "";
        });

        musicInput.addEventListener("change", function (e) {
          const file = e.target.files[0];
          musicFilename.textContent = file ? file.name : "";
        });

        // ××©×ª× ×™× ×’×œ×•×‘×œ×™×™×
        let slides = [];
        let currentSlideIndex = 0;
        let slideInterval;
        let backgroundImage = "";
        let musicFile = null;
        let imageCaptions = [];
        let transitions = [];

        // ×¢×“×›×•×Ÿ ×›×•×ª×¨×ª ×‘×–××Ÿ ×××ª
        titleInput.addEventListener("input", function () {
          titleDisplay.textContent = this.value;
        });

        // ×˜×¢×™× ×ª ×ª××•× ×•×ª - ×œ×œ× ×“×—×™×¡×”
        imagesInput.addEventListener("change", function (e) {
          const files = e.target.files;
          if (slides.length === 0) {
            slideshowContainer.innerHTML =
              '<div id="title-display" style="color: ' +
              titleColorInput.value +
              '">' +
              titleDisplay.textContent +
              "</div>";
          }

          imageCaptionsContainer.style.display = "block";

          if (files.length > 0) {
            progressBar.style.display = "block";
            progress.style.width = "0%";
            progress.textContent = "0%";

            const startIndex = slides.length;

            for (let i = 0; i < files.length; i++) {
              try {
                progress.style.width = `${((i + 1) / files.length) * 100}%`;
                progress.textContent = `${Math.round(
                  ((i + 1) / files.length) * 100
                )}%`;

                // ×©××™×¨×ª ×”×ª××•× ×” ×”××§×•×¨×™×ª
                originalImages.push(files[i]);

                // ×™×¦×™×¨×ª URL ×œ×ª×¦×•×’×” ××§×“×™××” ××”×§×•×‘×¥ ×”××§×•×¨×™
                const imgUrl = URL.createObjectURL(files[i]);
                imageUrls.push(imgUrl);

                const imageItem = document.createElement("div");
                imageItem.className = "image-item";

                const imgPreview = document.createElement("img");
                imgPreview.src = imgUrl;

                const deleteBtn = document.createElement("button");
                deleteBtn.textContent = "ğŸ—‘ï¸";
                deleteBtn.className = "delete-image-btn";
                deleteBtn.dataset.index = startIndex + i;
                deleteBtn.addEventListener("click", function () {
                  removeImage(parseInt(this.dataset.index));
                });

                const captionInput = document.createElement("input");
                captionInput.type = "text";
                captionInput.placeholder = "×›×•×ª×¨×ª ×œ×ª××•× ×” ×–×•";
                captionInput.dataset.index = startIndex + i;
                captionInput.className = "caption-input";
                captionInput.addEventListener("input", updateCaption);

                const transitionSelect = document.createElement("select");
                transitionSelect.dataset.index = startIndex + i;
                transitionSelect.className = "transition-select";
                transitionSelect.innerHTML = `
                  <option value="fade">×¢××¢×•×</option>
                  <option value="slide">×”×—×œ×§×”</option>
                  <option value="zoom">×ª×§×¨×™×‘</option>
                  <option value="rotate">×¡×™×‘×•×‘</option>
                  <option value="flip">×”×™×¤×•×š</option>
                  <option value="glow">× ×¦× ×•×¥</option>
                  <option value="bounce">×§×¤×™×¦×”</option>
                  <option value="flipX">×”×™×¤×•×š ××•×¤×§×™</option>
                  <option value="flipY">×”×™×¤×•×š ×× ×›×™</option>
                  <option value="lightSpeed">××”×™×¨×•×ª ××•×¨</option>
                  <option value="roll">×’×œ×’×•×œ</option>
                  <option value="blur">×˜×©×˜×•×©</option>
                  <option value="swing">× ×“× ×•×“</option>
                  <option value="wipe">× ×™×’×•×‘</option>
                  <option value="split">×¤×™×¦×•×œ</option>
                  <option value="ripple">×’×œ×™×</option>
                  <option value="blinds">×ª×¨×™×¡×™×</option>
                  <option value="rain">×’×©×</option>
                  <option value="pulse">×¤×¢×™××”</option>
                  <option value="fireWorks">×–×™×§×•×§×™×</option>
                  <option value="float">×¦×™×¤×”</option>
                  <option value="shrink">×”×ª×›×•×•×¦×•×ª</option>
                  <option value="expand">×”×ª×¨×—×‘×•×ª</option>
                  <option value="pageFlip">×× ×™××¦×™×™×ª ×¡×¤×¨</option>
                  <option value="vortex">××¢×¨×‘×•×œ×ª</option>
                  <option value="slideDiagonal">×”×—×œ×§×” ××œ×›×¡×•× ×™×ª</option>
                  <option value="pixelate">×¤×™×§×¡×œ×¦×™×”</option>
                  <option value="colorShift">×”×—×œ×¤×ª ×¦×‘×¢</option>
                  <option value="curtain">×”×•×¨×“×ª ××¡×š</option>
                  <option value="explode">×”×ª×¤×•×¦×¦×•×ª</option>
                  <option value="warp">×”×ª××‘×›×•×ª</option>
                  <option value="thunder">×¨×¢×</option>
                  <option value="smoke">×¢×©×Ÿ</option>
                  <option value="hourglass">×©×¢×•×Ÿ ×—×•×œ</option>
                  <option value="stars">×›×•×›×‘×™×</option>
                `;
                transitionSelect.value = defaultTransition;
                transitionSelect.addEventListener("change", updateTransition);

                imageItem.appendChild(captionInput);
                imageItem.appendChild(transitionSelect);
                imageItem.appendChild(imgPreview);
                imageItem.appendChild(deleteBtn);
                imageList.appendChild(imageItem);

                const slide = document.createElement("div");
                slide.className = "slide";
                slide.style.backgroundImage = `url(${imgUrl})`;

                const caption = document.createElement("div");
                caption.className = "image-caption";
                caption.textContent = "";
                caption.id = `caption-${startIndex + i}`;
                slide.appendChild(caption);

                slideshowContainer.appendChild(slide);
                slides.push(slide);
                transitions.push(defaultTransition);
                imageCaptions.push("");

                if (slides.length === 1) {
                  slide.classList.add("active");
                }
              } catch (error) {
                console.error("Error processing image:", error);
              }
            }

            progress.style.width = "100%";
            progress.textContent = "100%";
            setTimeout(() => (progressBar.style.display = "none"), 1000);

            startSlideshow();
          }
        });

        function removeImage(index) {
          // ×”×¡×¨×ª ×”××œ×× ×˜×™× ××”×“×£
          slides[index].remove();
          imageList.children[index].remove();

          // ×©×—×¨×•×¨ ×”-URL ×©×œ ×”×ª××•× ×”
          URL.revokeObjectURL(imageUrls[index]);

          // ×¢×“×›×•×Ÿ ×”××¢×¨×›×™×
          slides.splice(index, 1);
          originalImages.splice(index, 1);
          imageUrls.splice(index, 1);
          imageCaptions.splice(index, 1);
          transitions.splice(index, 1);

          // ×¢×“×›×•×Ÿ ×”××™× ×“×§×¡×™× ×©×œ ×”××œ×× ×˜×™× ×”× ×•×ª×¨×™×
          const items = imageList.querySelectorAll(".image-item");
          items.forEach((item, i) => {
            item.querySelector(".caption-input").dataset.index = i;
            item.querySelector(".transition-select").dataset.index = i;
            item.querySelector(".delete-image-btn").dataset.index = i;
          });

          // ×× ×–×• ×”×™×™×ª×” ×”×©×§×•×¤×™×ª ×”×¤×¢×™×œ×”, × ×¢×‘×•×¨ ×œ×©×§×•×¤×™×ª 0
          if (currentSlideIndex === index) {
            currentSlideIndex = 0;
            if (slides.length > 0) {
              slides[0].classList.add("active");
            }
          } else if (currentSlideIndex > index) {
            currentSlideIndex--;
          }

          // ×× ××™×Ÿ ×™×•×ª×¨ ×©×§×•×¤×™×•×ª, × ×§×” ××ª ×”×ª×¦×•×’×” ×”××§×“×™××”
          if (slides.length === 0) {
            slideshowContainer.innerHTML =
              '<div id="title-display" style="color: ' +
              titleColorInput.value +
              '">' +
              titleDisplay.textContent +
              "</div>";
            imageCaptionsContainer.style.display = "none";
          }
        }

        function updateCaption(e) {
          const index = parseInt(e.target.dataset.index);
          imageCaptions[index] = e.target.value;
          document.getElementById(`caption-${index}`).textContent =
            e.target.value;
        }

        function updateTransition(e) {
          const index = parseInt(e.target.dataset.index);
          transitions[index] = e.target.value;
        }

        async function compressImage(file, quality, maxWidth) {
          return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = function (event) {
              const img = new Image();
              img.onload = function () {
                const canvas = document.createElement("canvas");
                let width = img.width;
                let height = img.height;

                if (width > maxWidth) {
                  height = (maxWidth / width) * height;
                  width = maxWidth;
                }

                canvas.width = width;
                canvas.height = height;

                const ctx = canvas.getContext("2d");
                ctx.drawImage(img, 0, 0, width, height);

                canvas.toBlob(
                  function (blob) {
                    const reader = new FileReader();
                    reader.onload = function () {
                      resolve(reader.result);
                    };
                    reader.readAsDataURL(blob);
                  },
                  "image/jpeg",
                  quality / 100
                );
              };
              img.onerror = reject;
              img.src = event.target.result;
            };
            reader.onerror = reject;
            reader.readAsDataURL(file);
          });
        }

        backgroundInput.addEventListener("change", async function (e) {
          const file = e.target.files[0];
          if (file) {
            try {
              backgroundImage = await compressImage(
                file,
                bgQuality.value,
                resizeWidth.value
              );
              document.getElementById(
                "preview"
              ).style.backgroundImage = `url(${backgroundImage})`;
              document.getElementById("preview").style.backgroundSize = "cover";
            } catch (error) {
              console.error("Error processing background:", error);
            }
          }
        });

        musicInput.addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file) {
            if (file.size > 5 * 1024 * 1024) {
              if (confirm("×§×•×‘×¥ ×”××•×¡×™×§×” ×’×“×•×œ ×-5MB. ×¨×¦×•×Ÿ ×œ×”××©×™×š ×œ×œ× ×“×—×™×¡×”?")) {
                readMusicFile(file);
              }
            } else {
              readMusicFile(file);
            }
          }
        });

        function readMusicFile(file) {
          const reader = new FileReader();
          reader.onload = function (event) {
            musicFile = event.target.result;
          };
          reader.readAsDataURL(file);
        }

        function startSlideshow() {
          clearInterval(slideInterval);

          const interval = intervalInput.value * 1000;
          slideInterval = setInterval(nextSlide, interval);
        }

        function nextSlide() {
          if (slides.length === 0) return;

          const currentSlide = slides[currentSlideIndex];
          currentSlide.classList.remove("active");

          currentSlideIndex = (currentSlideIndex + 1) % slides.length;
          const nextSlide = slides[currentSlideIndex];
          nextSlide.classList.add("active");

          const transition =
            transitions[currentSlideIndex] || defaultTransition;
          applyTransition(currentSlide, nextSlide, transition);
        }

        function applyTransition(current, next, transition) {
          current.style.animation = "";
          next.style.animation = "";

          switch (transition) {
            case "fade":
              break;
            case "slide":
              current.style.animation = "slideOut 2s forwards";
              next.style.animation = "slideIn 2s forwards";
              break;
            case "zoom":
              current.style.animation = "zoomOut 2s forwards";
              next.style.animation = "zoomIn 2s forwards";
              break;
            case "rotate":
              current.style.animation = "rotateOut 2s forwards";
              next.style.animation = "rotateIn 2s forwards";
              break;
            case "flip":
              current.style.animation = "flipOut 2s forwards";
              next.style.animation = "flipIn 2s forwards";
              break;
            case "glow":
              current.style.animation = "glowOut 2s forwards";
              next.style.animation = "glowIn 2s forwards";
              break;
            case "bounce":
              current.style.animation = "bounceOut 2s forwards";
              next.style.animation = "bounceIn 2s forwards";
              break;
            case "flipX":
              current.style.animation = "flipXOut 2s forwards";
              next.style.animation = "flipXIn 2s forwards";
              break;
            case "flipY":
              current.style.animation = "flipYOut 2s forwards";
              next.style.animation = "flipYIn 2s forwards";
              break;
            case "lightSpeed":
              current.style.animation = "lightSpeedOut 2s forwards";
              next.style.animation = "lightSpeedIn 2s forwards";
              break;
            case "roll":
              current.style.animation = "rollOut 2s forwards";
              next.style.animation = "rollIn 2s forwards";
              break;
            case "blur":
              current.style.animation = "blurOut 2s forwards";
              next.style.animation = "blurIn 2s forwards";
              break;
            case "swing":
              current.style.animation = "swingOut 2s forwards";
              next.style.animation = "swingIn 2s forwards";
              break;
            case "wipe":
              current.style.animation = "wipeOut 2s forwards";
              next.style.animation = "wipeIn 2s forwards";
              break;
            case "split":
              current.style.animation = "splitOut 2s forwards";
              next.style.animation = "splitIn 2s forwards";
              break;
            case "ripple":
              current.style.animation = "rippleOut 2s forwards";
              next.style.animation = "rippleIn 2s forwards";
              break;
            case "blinds":
              current.style.animation = "blindsOut 2s forwards";
              next.style.animation = "blindsIn 2s forwards";
              break;
            case "rain":
              current.style.animation = "rainOut 2s forwards";
              next.style.animation = "rainIn 2s forwards";
              break;
            case "pulse":
              current.style.animation = "pulseOut 2s forwards";
              next.style.animation = "pulseIn 2s forwards";
              break;
            case "fireWorks":
              current.style.animation = "fireWorksOut 2s forwards";
              next.style.animation = "fireWorksIn 2s forwards";
              break;
            case "float":
              current.style.animation = "floatOut 2s forwards";
              next.style.animation = "floatIn 2s forwards";
              break;
            case "shrink":
              current.style.animation = "shrinkOut 2s forwards";
              next.style.animation = "shrinkIn 2s forwards";
              break;
            case "expand":
              current.style.animation = "expandOut 2s forwards";
              next.style.animation = "expandIn 2s forwards";
              break;
            case "pageFlip":
              current.style.animation = "pageFlipOut 2s forwards";
              next.style.animation = "pageFlipIn 2s forwards";
              break;
            case "vortex":
              current.style.animation = "vortexOut 2s forwards";
              next.style.animation = "vortexIn 2s forwards";
              break;
            case "slideDiagonal":
              current.style.animation = "slideDiagonalOut 2s forwards";
              next.style.animation = "slideDiagonalIn 2s forwards";
              break;
            case "pixelate":
              current.style.animation = "pixelateOut 2s forwards";
              next.style.animation = "pixelateIn 2s forwards";
              break;
            case "colorShift":
              current.style.animation = "colorShiftOut 2s forwards";
              next.style.animation = "colorShiftIn 2s forwards";
              break;
            case "curtain":
              current.style.animation = "curtainOut 2s forwards";
              next.style.animation = "curtainIn 2s forwards";
              break;
            case "explode":
              current.style.animation = "explodeOut 2s forwards";
              next.style.animation = "explodeIn 2s forwards";
              break;
            case "warp":
              current.style.animation = "warpOut 2s forwards";
              next.style.animation = "warpIn 2s forwards";
              break;
            case "jigsaw":
              current.style.animation = "jigsawOut 2s forwards";
              next.style.animation = "jigsawIn 2s forwards";
              break;
            case "thunder":
              current.style.animation = "thunderOut 2s forwards";
              next.style.animation = "thunderIn 2s forwards";
              break;
            case "smoke":
              current.style.animation = "smokeOut 2s forwards";
              next.style.animation = "smokeIn 2s forwards";
              break;
            case "hourglass":
              current.style.animation = "hourglassOut 2s forwards";
              next.style.animation = "hourglassIn 2s forwards";
              break;
            case "stars":
              current.style.animation = "starsOut 2s forwards";
              next.style.animation = "starsIn 2s forwards";
              break;
          }
        }

        refreshBtn.addEventListener("click", function () {
          // ×©×—×¨×•×¨ ×›×œ ×”-URLs ×©×œ ×”×ª××•× ×•×ª ×œ×¤× ×™ ×¨×¢× ×•×Ÿ ×”×“×£
          imageUrls.forEach((url) => URL.revokeObjectURL(url));
          location.reload();
        });

        exportBtn.addEventListener("click", async function () {
          if (slides.length === 0) {
            alert("×× × ×”×¢×œ×” ×œ×¤×—×•×ª ×ª××•× ×” ××—×ª ×œ×¤× ×™ ×”×™×¦×•×");
            return;
          }

          progressBar.style.display = "block";
          progress.style.width = "0%";
          progress.textContent = "0%";

          try {
            // ×“×—×™×¡×ª ×”×ª××•× ×•×ª ×œ×¤×™ ×”×¤×¨××˜×¨×™× ×©× ×‘×—×¨×•
            const exportImages = [];
            for (let i = 0; i < originalImages.length; i++) {
              progress.style.width = `${
                ((i + 1) / originalImages.length) * 100
              }%`;
              progress.textContent = `${Math.round(
                ((i + 1) / originalImages.length) * 100
              )}%`;

              const compressedImg = await compressImage(
                originalImages[i],
                imageQuality.value,
                resizeWidth.value
              );
              exportImages.push(compressedImg);
            }

            // ×™×¦×™×¨×ª ×§×•×‘×¥ ×”-HTML ×¢× ×”×ª××•× ×•×ª ×”×“×—×•×¡×•×ª
            let htmlContent = `<!DOCTYPE html>
      <html lang="he">
      <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <link rel="icon" type="image/x-icon" href="slide.png" />
          <title>${titleInput.value || "××¦×’×ª ×ª××•× ×•×ª"}</title>
          <style>
              body {
                  font-family: 'Arial', sans-serif;
                  direction: rtl;
                  margin: 0;
                  padding: 0;
                  overflow: hidden;
              }
              
              #slideshow-container {
                  width: 100vw;
                  height: 100vh;
                  position: relative;
                  overflow: hidden;
                  ${
                    backgroundImage
                      ? `background-image: url(${backgroundImage}); background-size: cover;`
                      : ""
                  }
              }
              
              .slide {
                  position: absolute;
                  width: 80%;
                  height: 80%;
                  opacity: 0;
                  transition: opacity 1s;
                  background-size: contain;
                  background-position: center;
                  background-repeat: no-repeat;
                  top: 10%;
                  left: 10%;
              }
              
              .slide.active {
                  opacity: 1;
              }
              
              #title-display {
                  position: absolute;
                  top: 20px;
                  left: 25%;
                  right: 25%;
                  text-align: center;
                  color: ${titleColorInput.value};
                  font-size: 3.5rem;
                  z-index: 10;
                  -webkit-text-stroke-width: 1px;
                  -webkit-text-stroke-color: rgb(255, 255, 0);
              }
              
              .image-caption {
                  position: absolute;
                  bottom: 20px;
                  left: 0;
                  right: 0;
                  text-align: center;
                  color: white;
                  -webkit-text-stroke-width: 2px;
                  -webkit-text-stroke-color: rgb(0, 0, 0);
                  font-size: 40px;
                  z-index: 10;
                  padding: 10px;
                  border-radius: 5px;
              }
              
              /* ×›×œ ×× ×™××¦×™×•×ª ×”××¢×‘×¨ */
              @keyframes slideOut {
                  from { transform: translateX(0); }
                  to { transform: translateX(-100%); }
              }
              
              @keyframes slideIn {
                  from { transform: translateX(100%); }
                  to { transform: translateX(0); }
              }
              
              @keyframes zoomOut {
                  from { transform: scale(1); }
                  to { transform: scale(0); }
              }
              
              @keyframes zoomIn {
                  from { transform: scale(2); }
                  to { transform: scale(1); }
              }
              
              @keyframes rotateOut {
                  from { transform: rotate(0deg); }
                  to { transform: rotate(180deg) scale(0); }
              }
              
              @keyframes rotateIn {
                  from { transform: rotate(-180deg) scale(0); }
                  to { transform: rotate(0deg) scale(1); }
              }
              
              @keyframes flipOut {
                  from { transform: rotateY(0); }
                  to { transform: rotateY(90deg); opacity: 0; }
              }
              
              @keyframes flipIn {
                  from { transform: rotateY(-90deg); opacity: 0; }
                  to { transform: rotateY(0); opacity: 1; }
              }
              
              @keyframes glowOut {
                  from { opacity: 1; filter: brightness(1); }
                  to { opacity: 0; filter: brightness(3); }
              }
              
              @keyframes glowIn {
                  from { opacity: 0; filter: brightness(3); }
                  to { opacity: 1; filter: brightness(1); }
              }
              
              @keyframes bounceOut {
                  from { transform: scale(1); }
                  to { transform: scale(0.5) translateY(100%); opacity: 0; }
              }
              
              @keyframes bounceIn {
                  from { transform: scale(0.5) translateY(-100%); opacity: 0; }
                  to { transform: scale(1); opacity: 1; }
              }
              
              @keyframes flipXOut {
                  from { transform: rotateX(0); }
                  to { transform: rotateX(90deg); opacity: 0; }
              }
              
              @keyframes flipXIn {
                  from { transform: rotateX(-90deg); opacity: 0; }
                  to { transform: rotateX(0); opacity: 1; }
              }
              
              @keyframes flipYOut {
                  from { transform: rotateY(0); }
                  to { transform: rotateY(90deg); opacity: 0; }
              }
              
              @keyframes flipYIn {
                  from { transform: rotateY(-90deg); opacity: 0; }
                  to { transform: rotateY(0); opacity: 1; }
              }
              
              @keyframes lightSpeedOut {
                  from { transform: translateX(0) skewX(0); }
                  to { transform: translateX(100%) skewX(-30deg); opacity: 0; }
              }
              
              @keyframes lightSpeedIn {
                  from { transform: translateX(-100%) skewX(30deg); opacity: 0; }
                  to { transform: translateX(0) skewX(0); opacity: 1; }
              }
              
              @keyframes rollOut {
                  from { transform: translateX(0) rotate(0); }
                  to { transform: translateX(100%) rotate(120deg); opacity: 0; }
              }
              
              @keyframes rollIn {
                  from { transform: translateX(-100%) rotate(-120deg); opacity: 0; }
                  to { transform: translateX(0) rotate(0); opacity: 1; }
              }
              
              @keyframes blurOut {
                  from { filter: blur(0); opacity: 1; }
                  to { filter: blur(5px); opacity: 0; }
              }
              
              @keyframes blurIn {
                  from { filter: blur(5px); opacity: 0; }
                  to { filter: blur(0); opacity: 1; }
              }
              
              @keyframes swingOut {
                  from { transform: rotate(0); }
                  to { transform: rotate(15deg) translateX(100%); opacity: 0; }
              }
              
              @keyframes swingIn {
                  from { transform: rotate(-15deg) translateX(-100%); opacity: 0; }
                  to { transform: rotate(0); opacity: 1; }
              }
              
              @keyframes wipeOut {
                  from { clip-path: inset(0 0 0 0); }
                  to { clip-path: inset(0 100% 0 0); }
              }
              
              @keyframes wipeIn {
                  from { clip-path: inset(0 0 0 100%); }
                  to { clip-path: inset(0 0 0 0); }
              }
              
              @keyframes splitOut {
                  from { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
                  to { 
                    clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%),
                               polygon(50% 0, 100% 0, 100% 100%, 50% 100%); 
                    transform: translateX(-50%) translateX(50%);
                  }
              }
              
              @keyframes splitIn {
                  from { 
                    clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%),
                               polygon(50% 0, 100% 0, 100% 100%, 50% 100%); 
                    transform: translateX(-50%) translateX(50%);
                  }
                  to { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
              }
              
              @keyframes rippleOut {
                  from { clip-path: circle(100%); }
                  to { clip-path: circle(0%); }
              }
              
              @keyframes rippleIn {
                  from { clip-path: circle(0%); }
                  to { clip-path: circle(100%); }
              }
              
              @keyframes blindsOut {
                  from { clip-path: inset(0 0 0 0); }
                  to { clip-path: inset(0 0 100% 0); }
              }
              
              @keyframes blindsIn {
                  from { clip-path: inset(100% 0 0 0); }
                  to { clip-path: inset(0 0 0 0); }
              }
              
              @keyframes rainOut {
                  from { transform: translateY(0); opacity: 1; }
                  to { transform: translateY(100%); opacity: 0; }
              }
              
              @keyframes rainIn {
                  from { transform: translateY(-100%); opacity: 0; }
                  to { transform: translateY(0); opacity: 1; }
              }
              
              @keyframes pulseOut {
                  from { transform: scale(1); opacity: 1; }
                  to { transform: scale(1.5); opacity: 0; }
              }
              
              @keyframes pulseIn {
                  from { transform: scale(0.5); opacity: 0; }
                  to { transform: scale(1); opacity: 1; }
              }
              
              @keyframes fireWorksOut {
                  from { opacity: 1; }
                  to { 
                    opacity: 0; 
                    box-shadow: 0 0 5px 5px rgba(255, 255, 0, 0.8),
                                0 0 10px 10px rgba(255, 0, 0, 0.6),
                                0 0 15px 15px rgba(0, 255, 0, 0.4);
                  }
              }
              
              @keyframes fireWorksIn {
                  from { 
                    opacity: 0; 
                    box-shadow: 0 0 5px 5px rgba(255, 255, 0, 0.8),
                                0 0 10px 10px rgba(255, 0, 0, 0.6),
                                0 0 15px 15px rgba(0, 255, 0, 0.4);
                  }
                  to { 
                    opacity: 1; 
                    box-shadow: none;
                  }
              }
              
              #music-controls {
                  position: fixed;
                  bottom: 20px;
                  right: 20px;
                  z-index: 1000;
                  display: flex;
                  gap: 10px;
              }
              
              #play-music-btn, #pause-music-btn {
                  padding: 10px 15px;
                  background: #4CAF50;
                  color: white;
                  border: none;
                  border-radius: 5px;
                  cursor: pointer;
              }
              
              #pause-music-btn {
                  background: #f44336;
              }
          </style>
      </head>
      <body>
          <div id="slideshow-container">
              <div id="title-display" style="color: ${titleColorInput.value}">${
              titleInput.value || "×›×•×ª×¨×ª ×”××¦×’×ª"
            }</div>`;

            // ×”×•×¡×¤×ª ×”×ª××•× ×•×ª ×”×“×—×•×¡×•×ª ×œ×§×•×‘×¥ ×”-HTML
            for (let i = 0; i < exportImages.length; i++) {
              const imgUrl = exportImages[i];
              const caption = imageCaptions[i] || "";
              htmlContent += `
              <div class="slide${
                i === 0 ? " active" : ""
              }" style="background-image: url(${imgUrl})">
                  <div class="image-caption">${caption}</div>
              </div>`;
            }

            htmlContent += `
          </div>
          
          ${
            musicFile
              ? `<audio id="bg-music" loop autoplay><source src="${musicFile}" type="audio/mpeg"></audio>
              <div id="music-controls">
                  <button id="play-music-btn">×”×¤×¢×œ ××•×¡×™×§×”</button>
                  <button id="pause-music-btn">×”×©×ª×§ ××•×¡×™×§×”</button>
              </div>`
              : ""
          }
          
          <script>
          const slides = document.querySelectorAll('.slide');
          let currentSlideIndex = 0;
          const interval = ${intervalInput.value * 1000};
          const transitions = ${JSON.stringify(transitions)};
          let musicPlaying = false;
          
          window.onload = function() {
              if (slides.length > 0) {
                  slides[0].classList.add('active');
              }
              
              const bgMusic = document.getElementById('bg-music');
              const playBtn = document.getElementById('play-music-btn');
              const pauseBtn = document.getElementById('pause-music-btn');
              
              if (bgMusic) {
                  bgMusic.play().then(() => {
                      musicPlaying = true;
                      playBtn.style.display = 'none';
                      pauseBtn.style.display = 'block';
                  }).catch(e => {
                      console.log('×”×¤×¢×œ×” ××•×˜×•××˜×™×ª × ×›×©×œ×” (××’×‘×œ×•×ª ×“×¤×“×¤×Ÿ):', e);
                  });
                  
                  document.addEventListener('click', function playOnFirstInteraction() {
                      if (!musicPlaying) {
                          bgMusic.play().then(() => {
                              musicPlaying = true;
                              playBtn.style.display = 'none';
                              pauseBtn.style.display = 'block';
                          }).catch(e => {
                              console.log('×”×¤×¢×œ×ª ××•×¡×™×§×” × ×›×©×œ×”:', e);
                          });
                          document.removeEventListener('click', playOnFirstInteraction);
                      }
                  }, { once: true });
                  
                  document.addEventListener('keydown', function playOnFirstKey() {
                      if (!musicPlaying) {
                          bgMusic.play().then(() => {
                              musicPlaying = true;
                              playBtn.style.display = 'none';
                              pauseBtn.style.display = 'block';
                          }).catch(e => {
                              console.log('×”×¤×¢×œ×ª ××•×¡×™×§×” × ×›×©×œ×”:', e);
                          });
                          document.removeEventListener('keydown', playOnFirstKey);
                      }
                  }, { once: true });
                  
                  playBtn.addEventListener('click', function() {
                      bgMusic.play();
                      musicPlaying = true;
                      playBtn.style.display = 'none';
                      pauseBtn.style.display = 'block';
                  });
                  
                  pauseBtn.addEventListener('click', function() {
                      bgMusic.pause();
                      musicPlaying = false;
                      playBtn.style.display = 'block';
                      pauseBtn.style.display = 'none';
                  });
              }
          };
          
          function nextSlide() {
              const currentSlide = slides[currentSlideIndex];
              currentSlide.classList.remove('active');
              
              currentSlideIndex = (currentSlideIndex + 1) % slides.length;
              const nextSlide = slides[currentSlideIndex];
              nextSlide.classList.add('active');
              
              const transition = transitions[currentSlideIndex] || 'fade';
              applyTransition(currentSlide, nextSlide, transition);
          }
          
          function applyTransition(current, next, transition) {
              current.style.animation = '';
              next.style.animation = '';
              
              switch (transition) {
                  case 'fade':
                      break;
                  case 'slide':
                      current.style.animation = 'slideOut 2s forwards';
                      next.style.animation = 'slideIn 2s forwards';
                      break;
                  case 'zoom':
                      current.style.animation = 'zoomOut 2s forwards';
                      next.style.animation = 'zoomIn 2s forwards';
                      break;
                  case 'rotate':
                      current.style.animation = 'rotateOut 2s forwards';
                      next.style.animation = 'rotateIn 2s forwards';
                      break;
                  case 'flip':
                      current.style.animation = 'flipOut 2s forwards';
                      next.style.animation = 'flipIn 2s forwards';
                      break;
                  case 'glow':
                      current.style.animation = 'glowOut 2s forwards';
                      next.style.animation = 'glowIn 2s forwards';
                      break;
                  case 'bounce':
                      current.style.animation = 'bounceOut 2s forwards';
                      next.style.animation = 'bounceIn 2s forwards';
                      break;
                  case 'flipX':
                      current.style.animation = 'flipXOut 2s forwards';
                      next.style.animation = 'flipXIn 2s forwards';
                      break;
                  case 'flipY':
                      current.style.animation = 'flipYOut 2s forwards';
                      next.style.animation = 'flipYIn 2s forwards';
                      break;
                  case 'lightSpeed':
                      current.style.animation = 'lightSpeedOut 2s forwards';
                      next.style.animation = 'lightSpeedIn 2s forwards';
                      break;
                  case 'roll':
                      current.style.animation = 'rollOut 2s forwards';
                      next.style.animation = 'rollIn 2s forwards';
                      break;
                  case 'blur':
                      current.style.animation = 'blurOut 2s forwards';
                      next.style.animation = 'blurIn 2s forwards';
                      break;
                  case 'swing':
                      current.style.animation = 'swingOut 2s forwards';
                      next.style.animation = 'swingIn 2s forwards';
                      break;
                  case 'wipe':
                      current.style.animation = 'wipeOut 2s forwards';
                      next.style.animation = 'wipeIn 2s forwards';
                      break;
                  case 'split':
                      current.style.animation = 'splitOut 2s forwards';
                      next.style.animation = 'splitIn 2s forwards';
                      break;
                  case 'ripple':
                      current.style.animation = 'rippleOut 2s forwards';
                      next.style.animation = 'rippleIn 2s forwards';
                      break;
                  case 'blinds':
                      current.style.animation = 'blindsOut 2s forwards';
                      next.style.animation = 'blindsIn 2s forwards';
                      break;
                  case 'rain':
                      current.style.animation = 'rainOut 2s forwards';
                      next.style.animation = 'rainIn 2s forwards';
                      break;
                  case 'pulse':
                      current.style.animation = 'pulseOut 2s forwards';
                      next.style.animation = 'pulseIn 2s forwards';
                      break;
                  case 'fireWorks':
                      current.style.animation = 'fireWorksOut 2s forwards';
                      next.style.animation = 'fireWorksIn 2s forwards';
                      break;
              }
          }
          
          setInterval(nextSlide, interval);
          <\/script>
      </body>
      </html>`;

            try {
              const blob = new Blob([htmlContent], { type: "text/html" });
              const url = URL.createObjectURL(blob);

              const a = document.createElement("a");
              a.href = url;
              a.download = (titleInput.value || "slideshow") + ".html";
              document.body.appendChild(a);
              a.click();

              setTimeout(() => {
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                progressBar.style.display = "none";
              }, 100);
            } catch (e) {
              console.error("×©×’×™××” ×‘×™×¦×™×¨×ª ×”×§×•×‘×¥:", e);
              alert("××™×¨×¢×” ×©×’×™××” ×‘×™×¦×™×¨×ª ×”×§×•×‘×¥");
              progressBar.style.display = "none";
            }
          } catch (error) {
            console.error("×©×’×™××” ×‘×¢×™×‘×•×“ ×”×ª××•× ×•×ª:", error);
            alert("××™×¨×¢×” ×©×’×™××” ×‘×¢×™×‘×•×“ ×”×ª××•× ×•×ª");
            progressBar.style.display = "none";
          }
        });
      </script>
    </div>
  </body>
</html>
